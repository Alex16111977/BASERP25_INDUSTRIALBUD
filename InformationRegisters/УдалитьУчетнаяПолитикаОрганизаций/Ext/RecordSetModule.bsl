#Если Сервер Или ТолстыйКлиентОбычноеПриложение Или ВнешнееСоединение Тогда

#Область ОбработчикиСобытий

Процедура ПередЗаписью(Отказ, Замещение)
	
	Если ОбменДанными.Загрузка Тогда
		Возврат;
	КонецЕсли;

	ОбновлениеИнформационнойБазы.ПроверитьОбъектОбработан(ЭтотОбъект);

	Если ЭтотОбъект.Количество() = 0 Тогда
		Возврат
	КонецЕсли;
	
	// Заполним ресурсы регистра, кэшируемые из справочника учетной политики.
	КэшПараметровПоОрганизациям = Новый Соответствие;
	
	Для Каждого ТекСтр Из ЭтотОбъект Цикл
		
		ПараметрыУчетнойПолитики = Неопределено;
		ДанныеКэша = КэшПараметровПоОрганизациям.Получить(ТекСтр.Организация);
		
		Если ДанныеКэша <> Неопределено Тогда
			
			ПараметрыУчетнойПолитики = ДанныеКэша.Получить(ТекСтр.УчетнаяПолитика);
			
			Если ПараметрыУчетнойПолитики = Неопределено Тогда
				
				ПараметрыУчетнойПолитики = РегистрыСведений.УдалитьУчетнаяПолитикаОрганизаций.СформироватьКэшируемыеПараметрыУчетнойПолитики(
					ТекСтр.УчетнаяПолитика,
					ТекСтр.Организация);
				
				КэшПараметровПоОрганизациям[ТекСтр.Организация].Вставить(ТекСтр.УчетнаяПолитика, ПараметрыУчетнойПолитики);
				
			КонецЕсли;
			
		Иначе
			
			КэшПараметровПоОрганизациям.Вставить(
				ТекСтр.Организация,
				Новый Соответствие);
				
			ПараметрыУчетнойПолитики = РегистрыСведений.УдалитьУчетнаяПолитикаОрганизаций.СформироватьКэшируемыеПараметрыУчетнойПолитики(
				ТекСтр.УчетнаяПолитика,
				ТекСтр.Организация);
				
			КэшПараметровПоОрганизациям[ТекСтр.Организация].Вставить(ТекСтр.УчетнаяПолитика, ПараметрыУчетнойПолитики);
			
		КонецЕсли;
		
		ЗаполнитьЗначенияСвойств(ТекСтр, ПараметрыУчетнойПолитики);
		
	КонецЦикла;
	
КонецПроцедуры

Процедура ПриЗаписи(Отказ, Замещение)
	
	Если ОбменДанными.Загрузка Тогда
		Возврат;
	КонецЕсли;

	Если ЭтотОбъект.Количество() = 0 Тогда
		Возврат
	КонецЕсли;
	
	
КонецПроцедуры

#КонецОбласти

#КонецЕсли
