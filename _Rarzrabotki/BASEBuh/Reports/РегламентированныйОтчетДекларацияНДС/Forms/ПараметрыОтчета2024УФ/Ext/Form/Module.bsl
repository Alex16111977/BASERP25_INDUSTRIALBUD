
// ПриСозданииНаСервере()
//
&НаСервере
Процедура ПриСозданииНаСервере(Отказ, СтандартнаяОбработка)
	
	мСпрашиватьОСохранении = Истина;
	мПрограммноеЗакрытие   = Ложь;
	
	Организация = Параметры.Организация;
	
	мДатаНачалаПериодаОтчета = Параметры.мДатаНачалаПериодаОтчета;
	мДатаКонцаПериодаОтчета  = Параметры.мДатаКонцаПериодаОтчета;
	
	ОтчетЗаДваМесяца 			   = Параметры.ОтчетЗаДваМесяца;
	НеВыдаватьСообщенияОбОшибкахВРасчете = Параметры.НеВыдаватьСообщенияОбОшибкахВРасчете;
	ВыгружатьСправку 			   = Параметры.ВыгружатьСправку;
	ЗаполнятьПриложение5Год = Параметры.ЗаполнятьПриложение5Год;
	
КонецПроцедуры // ПриСозданииНаСервере()

// Сохранить()
//
&НаКлиенте
Процедура Сохранить(Команда)
	
	мСпрашиватьОСохранении = Ложь;
	Закрыть();
	
КонецПроцедуры // Сохранить()

// ПередЗакрытием()
//
&НаКлиенте
Процедура ПередЗакрытием(Отказ, ЗавершениеРаботы, ТекстПредупреждения, СтандартнаяОбработка)
	
	Если ЗавершениеРаботы <> Неопределено Тогда 
		
		Если ЗавершениеРаботы И Модифицированность Тогда
			Отказ = Истина;
			Возврат;
		КонецЕсли;
		
	КонецЕсли;

	СтандартнаяОбработка = Ложь;
	Если мПрограммноеЗакрытие = Истина Тогда
		Возврат;
	КонецЕсли;
	
	Если НЕ ПроверитьЗаполнение() Тогда
		
		Отказ = Истина;
		Возврат;
		
	КонецЕсли;
	
	Если мСпрашиватьОСохранении <> Ложь И Модифицированность Тогда
		
		Отказ = Истина;
		
		ОписаниеОповещения = Новый ОписаниеОповещения("ПередЗакрытиемЗавершение", ЭтотОбъект);
		ПоказатьВопрос(ОписаниеОповещения, НСтр("ru='Настройки были изменены. Сохранить изменения?';uk='Настройки були змінені. Зберегти зміни?'"), РежимДиалогаВопрос.ДаНетОтмена);
		Возврат;
		
	ИначеЕсли мСпрашиватьОСохранении <> Ложь И НЕ Модифицированность Тогда
		
		Возврат;
		
	КонецЕсли;
	
	ДействияПриЗакрытии();
	
КонецПроцедуры

&НаКлиенте
Процедура ДействияПриЗакрытии()
	
	ВладелецФормы.СтруктураРеквизитовФормы.ОтчетЗаДваМесяца = ОтчетЗаДваМесяца;
	ВладелецФормы.СтруктураРеквизитовФормы.НеВыдаватьСообщенияОбОшибкахВРасчете = НеВыдаватьСообщенияОбОшибкахВРасчете;
	ВладелецФормы.СтруктураРеквизитовФормы.ВыгружатьСправку = ВыгружатьСправку;
	ВладелецФормы.СтруктураРеквизитовФормы.ЗаполнятьПриложение5Год = ЗаполнятьПриложение5Год;
	
	мПрограммноеЗакрытие = Истина;
	Отказ = Истина;
	
	ПараметрыВозврата = Новый Структура();
	
	Закрыть(ПараметрыВозврата);
	
КонецПроцедуры // ПередЗакрытием()

&НаКлиенте
Процедура ПередЗакрытиемЗавершение(Ответ, ДополнительныеПараметры)Экспорт
	
	Если Ответ = КодВозвратаДиалога.Нет Тогда
		мПрограммноеЗакрытие = Истина;
		Закрыть();
		Возврат;
	ИначеЕсли Ответ = КодВозвратаДиалога.Отмена Тогда
		Возврат;
	КонецЕсли;
	
	ДействияПриЗакрытии();
	
КонецПроцедуры

&НаКлиенте
Процедура ОткрытьПомощникЗаполненияПриложения2(Команда)

	СтруктураИмениФормы = СтрРазделить(ИмяФормы, ".");
	СтруктураИмениФормы[СтруктураИмениФормы.ВГраница()] = "ПомощникЗаполненияПриложения2";
	ИмяФормыПомощника = СтрСоединить(СтруктураИмениФормы, ".");
	
	ПараметрыПомощника = ВладелецФормы.ПолучитьПараметрыОткрытияПомощникЗаполненияПриложения2();
	
	ОткрытьФорму(ИмяФормыПомощника, ПараметрыПомощника, ВладелецФормы);	
	
КонецПроцедуры
