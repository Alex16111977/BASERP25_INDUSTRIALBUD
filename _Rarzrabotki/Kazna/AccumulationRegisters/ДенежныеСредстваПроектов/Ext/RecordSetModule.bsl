Процедура ВыполнитьДвижениеОбщая(Объект, ЭтоРасход)
	
	МетаданныеОбъекта = Объект.Метаданные();
	Если ЭтоРасход Тогда
		НоваяСтрока = ДобавитьРасход();
	Иначе	
	     НоваяСтрока = ДобавитьПриход();
	КонецЕсли;
	
	
	Если МетаданныеОбъекта.Реквизиты.Найти("ДатаОплаты")<>Неопределено
		И ЗначениеЗаполнено(Объект.ДатаОплаты) Тогда
		НоваяСтрока.Период = Объект.ДатаОплаты;
	Иначе
		НоваяСтрока.Период = Объект.Дата;
	КонецЕсли;
	
	Если МетаданныеОбъекта.Реквизиты.Найти("Подразделение")<>Неопределено Тогда
		НоваяСтрока.Подразделение = Объект.Подразделение;
	КонецЕсли;
	
	Если МетаданныеОбъекта.Реквизиты.Найти("Организация")<>Неопределено Тогда
		НоваяСтрока.Организация = Объект.Организация;
	КонецЕсли;

	НоваяСтрока.Сумма = Окр(Объект.СуммаДокумента*0.2,2);
	
	Записывать = Истина;
	
КонецПроцедуры


Процедура ВыполнитьДвижение(Объект) Экспорт
	
	ТипОбъекта = ТипЗнч(Объект);
			
	ЭтоРасход = Ложь;
	
	Если Объект.Дата<Дата(2016,10,01) Тогда
		Возврат;
	КонецЕсли;
	
	Если ТипОбъекта=Тип("ДокументОбъект.ПриходныйКассовыйОрдер")   Тогда 
		Если Объект.ВидОперации <> Перечисления.ВидыОперацийПКО.ОплатаПокупателя Тогда
			Возврат;
		КонецЕсли;
		
	ИначеЕсли ТипОбъекта=Тип("ДокументОбъект.ПлатежноеПоручениеВходящее") Тогда
		Если Объект.ВидОперации <> Перечисления.ВидыОперацийПоступлениеБезналичныхДенежныхСредств.ОплатаПокупателя Тогда
			Возврат;
		КонецЕсли;

		Если НЕ Объект.Оплачено Тогда
			Возврат;
		КонецЕсли;
		
	ИначеЕсли ТипОбъекта=Тип("ДокументОбъект.ПлатежноеПоручениеИсходящее") Тогда
		ЭтоРасход = Истина;
		Возврат;
	ИначеЕсли ТипОбъекта=Тип("ДокументОбъект.РасходныйКассовыйОрдер") Тогда
		ЭтоРасход = Истина;
		Возврат;
	КонецЕсли; 
	
	ВыполнитьДвижениеОбщая(Объект, ЭтоРасход);
	
КонецПроцедуры