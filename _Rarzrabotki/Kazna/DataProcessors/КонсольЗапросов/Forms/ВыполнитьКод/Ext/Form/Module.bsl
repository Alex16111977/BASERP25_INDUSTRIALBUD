&НаКлиенте
Процедура ВыполнитьКодПродолжение(РезультатВопроса, ДополнительныеПараметры) Экспорт
	
	Если Элементы.ТаблицаКода.ТекущиеДанные=Неопределено Тогда
		Возврат;
	КонецЕсли;
	
	Если РезультатВопроса=КодВозвратаДиалога.Да Тогда
		Закрыть(Элементы.ТаблицаКода.ТекущиеДанные.ИсходныйКод);
	ИначеЕсли РезультатВопроса=КодВозвратаДиалога.Нет Тогда
		Закрыть();
	КонецЕсли;
	
КонецПроцедуры

&НаКлиенте
Процедура ВыполнитьКод(Команда)
	Если Элементы.ТаблицаКода.ТекущиеДанные=Неопределено Тогда
		Возврат;
	КонецЕсли; 
	ПоказатьВопрос(Новый ОписаниеОповещения("ВыполнитьКодПродолжение", ЭтотОбъект),
		"Вы действительно хотите выполнить код?",
		РежимДиалогаВопрос.ДаНетОтмена);
КонецПроцедуры

&НаКлиенте
Процедура ПриОткрытии(Отказ)
	
	Если ТаблицаКода.Количество()=0 Тогда
		НоваяСтрока = ТаблицаКода.Добавить();
		НоваяСтрока.Имя = "Обход результатов";
		НоваяСтрока.ИсходныйКод = "
		|Для Каждого Строка Из ТаблицаРезультата Цикл
		|	ОбъектСсылки = Строка.Ссылка.ПолучитьОбъект();
		|	ОбъектСсылки.Записать();
		|КонецЦикла;
		|";
	КонецЕсли; 

КонецПроцедуры