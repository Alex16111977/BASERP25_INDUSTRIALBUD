
&НаСервере
Процедура ПерепровестиСчетаНаСервере()
	
	Если Объект.Проведен Тогда 
		Запрос = Новый Запрос;
		Запрос.Текст = 
		"ВЫБРАТЬ
		|	ЛимитыПроектовЛимиты.Подразделение
		|ПОМЕСТИТЬ Подразд
		|ИЗ
		|	Документ.ЛимитыПроектов.Лимиты КАК ЛимитыПроектовЛимиты
		|ГДЕ
		|	ЛимитыПроектовЛимиты.Ссылка = &Ссылка
		|
		|СГРУППИРОВАТЬ ПО
		|	ЛимитыПроектовЛимиты.Подразделение
		|;
		|
		|////////////////////////////////////////////////////////////////////////////////
		|ВЫБРАТЬ
		|	СчетНаОплатуПоставщика.Ссылка
		|ИЗ
		|	Документ.СчетНаОплатуПоставщика КАК СчетНаОплатуПоставщика
		|ГДЕ
		|	СчетНаОплатуПоставщика.Подразделение В
		|			(ВЫБРАТЬ
		|				Подразд.Подразделение
		|			ИЗ
		|				Подразд КАК Подразд)
		|	И СчетНаОплатуПоставщика.Проведен
		|	И СчетНаОплатуПоставщика.Дата >= &Дата";
		
		Запрос.УстановитьПараметр("Дата", Объект.Дата);
		Запрос.УстановитьПараметр("Ссылка", Объект.Ссылка);
		
		Выборка = Запрос.Выполнить().Выбрать();
		Проведено = 0;
		Пока Выборка.Следующий() Цикл  
			ДокОбъект =  Выборка.Ссылка.Получитьобъект();
			Попытка          
				ДокОбъект.Записать(РежимЗаписиДокумента.Проведение);
				Проведено = Проведено +1;
			Исключение       
				Сообщить(ОписаниеОшибки());
			КонецПопытки;
			
		КонецЦикла;  
		Сообщить("Проведено "+ Проведено + " документов");
		
	Иначе         
		Сообщить("Проведите документ!");
	КонецЕсли;


КонецПроцедуры

&НаКлиенте
Процедура ПерепровестиСчета(Команда)
	ПерепровестиСчетаНаСервере();
КонецПроцедуры
