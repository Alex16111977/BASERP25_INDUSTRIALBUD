
Процедура ОбработкаПроведения(Отказ, Режим)
		// регистр БДДС 
	Движения.БДДС.Записывать = Истина;
	Для Каждого ТекСтрокаРаспределение Из Распределение Цикл
		СтатьяНачисления =  ТекСтрокаРаспределение.Сотрудник.СтатьяЗарплата;
		Если СтатьяНачисления.Пустая() Тогда
			СтатьяНачисления =  ТекСтрокаРаспределение.Сотрудник.Родитель.СтатьяЗарплата;
		КонецЕсли;
		
		//СтатьяФОТ=  ТекСтрокаРаспределение.Сотрудник.СтатьяНачисленияНаЗарплату;
		//Если СтатьяФОТ.Пустая() Тогда
		//	СтатьяФОТ =  ТекСтрокаРаспределение.Сотрудник.Родитель.СтатьяНачисленияНаЗарплату;
		//КонецЕсли;
		//
		//СтатьяНалогиСотрудника=  ТекСтрокаРаспределение.Сотрудник.СтатьяУдержанияСЗарплаты;
		//Если СтатьяНалогиСотрудника.Пустая() Тогда
		//	СтатьяНалогиСотрудника =  ТекСтрокаРаспределение.Сотрудник.Родитель.СтатьяУдержанияСЗарплаты;
		//КонецЕсли;
		
		
		//НАчислено
		Движение = Движения.БДДС.Добавить();
		Движение.Период = Дата;
		Движение.Подразделение = ТекСтрокаРаспределение.Подразделение;
		Движение.СтатьяДвиженияДенежныхСредств=СтатьяНачисления;
		Движение.ВидОплаты=Перечисления.ВидыДенежныхСредств.Наличные;
		Движение.НаправлениеДДС=Перечисления.НаправленияДвиженийДенежныхСредств.Расход;
		Движение.Сумма= ТекСтрокаРаспределение.СуммаНачисления;
		Движение.СуммаРасход=Движение.Сумма;
		Движение.Комментарий=ТекСтрокаРаспределение.Сотрудник;
		Если ЗначениеЗаполнено(ТекСтрокаРаспределение.Направление) Тогда
			Движение.Направление=ТекСтрокаРаспределение.Направление;
		Иначе	
			Движение.Направление=Направление;
		КонецЕсли;
		
				
		////Удержано с сотр
		//Движение = Движения.БДДС.Добавить();
		//Движение.Период = Дата;
		//Движение.Подразделение = ТекСтрокаРаспределение.Подразделение;
		//Движение.СтатьяДвиженияДенежныхСредств=СтатьяНалогиСотрудника;
		//Движение.ВидОплаты=Перечисления.ВидыДенежныхСредств.Безналичные;
		//Движение.НаправлениеДДС=Перечисления.НаправленияДвиженийДенежныхСредств.Расход;
		//Движение.Сумма= ТекСтрокаРаспределение.СуммаНалогов;
		//Движение.СуммаРасход=Движение.Сумма;
		//Движение.Комментарий=ТекСтрокаРаспределение.Сотрудник;
		//Если ЗначениеЗаполнено(ТекСтрокаРаспределение.Направление) Тогда
		//	Движение.Направление=ТекСтрокаРаспределение.Направление;
		//Иначе	
		//	Движение.Направление=Направление;
		//КонецЕсли;
		//
		//
		////ФОТ
		//Движение = Движения.БДДС.Добавить();
		//Движение.Период = Дата;
		//Движение.Подразделение = ТекСтрокаРаспределение.Подразделение;
		//Движение.СтатьяДвиженияДенежныхСредств=СтатьяФОТ;
		//Движение.ВидОплаты=Перечисления.ВидыДенежныхСредств.Безналичные;
		//Движение.НаправлениеДДС=Перечисления.НаправленияДвиженийДенежныхСредств.Расход;
		//Движение.Сумма= ТекСтрокаРаспределение.СуммаФОТ;
		//Движение.СуммаРасход=Движение.Сумма;
		//Движение.Комментарий=ТекСтрокаРаспределение.Сотрудник;
		//Если ЗначениеЗаполнено(ТекСтрокаРаспределение.Направление) Тогда
		//	Движение.Направление=ТекСтрокаРаспределение.Направление;
		//Иначе	
		//	Движение.Направление=Направление;
		//КонецЕсли;
		
		
		
	КонецЦикла;
	
	//Для  Каждого СтрокаИсключения Из СотрудникиИсключения Цикл
	//	
	//	СтрокиРаспределения = Распределение.НайтиСтроки(Новый Структура("Сотрудник",СтрокаИсключения.Сотрудник));
	//	
	//	ВсегоКВыплате = 0;
	//	Для каждого СтрРаспределение Из СтрокиРаспределения Цикл
	//			ВсегоКВыплате =ВсегоКВыплате +СтрРаспределение.СуммаНачисления-СтрРаспределение.СуммаНалогов;
	//	КонецЦикла;

	//	Если ВсегоКВыплате=0 Тогда
	//		//Не нащли такого сотрудника
	//		 Сообщить("Ошибка сторнирования кассы по сотруднику "+ СтрокаИсключения.Сотрудник);
	//		Продолжить;	
	//	КонецЕсли;
	//	
	//	Распределили = 0;
	//	Для каждого СтрРаспределение Из СтрокиРаспределения Цикл
	//		
	//		//Сторно начислений, выплаченных через кассу
	//		
	//		СтатьяНачисления =  СтрокаИсключения.Сотрудник.СтатьяЗарплата;
	//		Если СтатьяНачисления.Пустая() Тогда
	//			СтатьяНачисления =  СтрокаИсключения.Сотрудник.Родитель.СтатьяЗарплата;
	//		КонецЕсли;
	//		
	//		Движение =  Движения.БДДС.Добавить();
	//		Движение.Период = Дата;
	//		Движение.Подразделение = СтрРаспределение.Подразделение;
	//		Движение.СтатьяДвиженияДенежныхСредств=СтатьяНачисления;
	//		Движение.ВидОплаты=Перечисления.ВидыДенежныхСредств.Безналичные;
	//		Движение.НаправлениеДДС=Перечисления.НаправленияДвиженийДенежныхСредств.Расход;
	//		
	//		//ЗаполнитьЗначенияСвойств(ДвижениеСторно,Движение);
	//		Движение.Сумма=-СтрокаИсключения.СуммаВыплаты*
	//		((СтрРаспределение.СуммаНачисления-СтрРаспределение.СуммаНалогов)/ ВсегоКВыплате);
	//		Движение.СуммаРасход=Движение.Сумма;
	//		Движение.Комментарий=СтрРаспределение.Сотрудник;
	//		
	//		Если ЗначениеЗаполнено(СтрРаспределение.Направление) Тогда
	//			Движение.Направление=СтрРаспределение.Направление;
	//		Иначе	
	//			Движение.Направление=Направление;
	//		КонецЕсли;
	//		
	//		Распределили =Распределили +Движение.Сумма;
	//	КонецЦикла;
	//	
	//	РазницаРаспределили =  СтрокаИсключения.СуммаВыплаты=Распределили;
	//	Если РазницаРаспределили <>0 Тогда
	//		Движение.Сумма=Движение.Сумма+РазницаРаспределили;
	//		Движение.СуммаРасход=Движение.СуммаРасход+РазницаРаспределили;
	//	КонецЕсли;
	//	
	//КонецЦикла;
	
	
	//}}__КОНСТРУКТОР_ДВИЖЕНИЙ_РЕГИСТРОВ
КонецПроцедуры
