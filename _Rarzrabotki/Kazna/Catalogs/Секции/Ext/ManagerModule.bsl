Функция ЗаполнитьСписокСекций(Элемент, Подразделение, УстанавливатьВидимость = Истина) Экспорт
	
	// Управление видимостью
	Если УстанавливатьВидимость Тогда
		Элемент.Видимость = Подразделение.ДетализацияДоСекций;
	КонецЕсли;
	
	// На всякий случай ограничим видимость
	Элемент.ОграничениеТипа = Новый ОписаниеТипов("СправочникСсылка.Секции");
	
	// Заполним список выбора элемента формы.
	// Он может быть только чтением, поэтому передаем его в параметре.
	// Следует учесть одну особенность 1С. Если значение нет в списке выбора, оно будет пустым,
	// поэтому очищать его не стоит самому.
	Список = Элемент.СписокВыбора;
	Список.Очистить();
	
	Запрос = Новый Запрос(
	"ВЫБРАТЬ РАЗРЕШЕННЫЕ
	|	Секции.Ссылка
	|ИЗ
	|	Справочник.Секции КАК Секции
	|ГДЕ
	|	Секции.Владелец В ИЕРАРХИИ(&Владелец)
	|	И НЕ Секции.ПометкаУдаления"	
	);
	Запрос.УстановитьПараметр("Владелец", Подразделение.Родитель);
	Выборка = Запрос.Выполнить().Выбрать();
	
	Пока Выборка.Следующий() Цикл
		Список.Добавить(Выборка.Ссылка);
	КонецЦикла;
	
КонецФункции