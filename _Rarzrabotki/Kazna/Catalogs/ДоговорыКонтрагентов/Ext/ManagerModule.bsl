Функция ПолучитьСуммуСчетовПоДоговору(ДоговорКонтрагента, КонДата) Экспорт 
	УстановитьПривилегированныйРежим(Истина);
	Запрос = Новый Запрос;
	Запрос.Текст=  "ВЫБРАТЬ
	               |	ЕСТЬNULL(СУММА(СчетНаОплатуПоставщика.СуммаДокумента), 0) КАК СуммаДокумента
	               |ИЗ
	               |	Документ.СчетНаОплатуПоставщика КАК СчетНаОплатуПоставщика
	               |ГДЕ
	               |	СчетНаОплатуПоставщика.ДоговорКонтрагента = &ДоговорКонтрагента
	               |	И СчетНаОплатуПоставщика.Проведен
	               |	И СчетНаОплатуПоставщика.Дата <= &КонДата";
	Запрос.УстановитьПараметр("ДоговорКонтрагента",ДоговорКонтрагента); 
	Запрос.УстановитьПараметр("КонДата",КонДата); 
	
	Выборка = Запрос.Выполнить().Выбрать();  
	
	Если Выборка.Следующий() Тогда
		СуммаДокумента=Выборка.СуммаДокумента;
	Иначе	
	     СуммаДокумента= 0;
	КонецЕсли;
	
	УстановитьПривилегированныйРежим(Ложь);
	Возврат СуммаДокумента;
КонецФункции // ()
