
Функция ЗаполнитьСписокВыбора(Элемент) Экспорт
	
	// Заполним список выбора элемента формы.
	// Он может быть только чтением, поэтому передаем его в параметре.
	// Следует учесть одну особенность 1С. Если значение нет в списке выбора, оно будет пустым,
	// поэтому очищать его не стоит самому.
	Список = Элемент.СписокВыбора;
	Список.Очистить();
	
	НадоУстановитьПривилегированныйРежим = Ложь;
	НадоУстановитьПривилегированныйРежим = Истина;
	
	Если НадоУстановитьПривилегированныйРежим Тогда
		УстановитьПривилегированныйРежим(Истина);
	КонецЕсли; 
	
	ТекстЗапроса =
	"ВЫБРАТЬ РАЗРЕШЕННЫЕ
	|	Подразделения.Ссылка,
	|	Подразделения.Наименование
	|ИЗ
	|	Справочник.Сотрудники КАК Подразделения
	|ГДЕ
	|	Подразделения.НеИспользовать = ЛОЖЬ
	|	И ВЫБОР
	|			КОГДА Подразделения.Родитель = ЗНАЧЕНИЕ(Справочник.Сотрудники.ПустаяСсылка)
	|				ТОГДА Подразделения.НеИспользовать = ЛОЖЬ
	|			ИНАЧЕ Подразделения.Родитель.НеИспользовать = ЛОЖЬ
	|		КОНЕЦ";
	//Если НадоУстановитьПривилегированныйРежим Тогда
	//	ТекстЗапроса = СтрЗаменить(ТекстЗапроса, "РАЗРЕШЕННЫЕ", "");
	//	ТекстЗапроса = СтрЗаменить(ТекстЗапроса, "Элементы.Владелец В ИЕРАРХИИ(&Владелец)", "Истина");
	//КонецЕсли; 
	Запрос = Новый Запрос(ТекстЗапроса);
	Выборка = Запрос.Выполнить().Выбрать();
	
	Пока Выборка.Следующий() Цикл
		Список.Добавить(Выборка.Ссылка, Выборка.Наименование);
	КонецЦикла;
	
КонецФункции
