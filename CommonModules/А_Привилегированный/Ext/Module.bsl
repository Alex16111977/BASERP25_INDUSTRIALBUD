
Функция А_ПолучитьОрганизациюУпр() Экспорт
	
	Возврат Справочники.Организации.НайтиПоРеквизиту("КодПоЕДРПОУ","40645273"); //ТОВ "ІНДАСТРІАЛБУД"
	
КонецФункции //

 Функция А_ПроверкаВыбораЗаказаВДокументахПрихода(ЗаказПоставщику) Экспорт
 
 	     Запрос = Новый Запрос;
		 Запрос.УстановитьПараметр("ЗаказПоставщику",ЗаказПоставщику);
		 Запрос.Текст =   "ВЫБРАТЬ
		                  |	ПоступлениеТоваровНаСклад.Ссылка КАК Ссылка
		                  |ИЗ
		                  |	Документ.ПриобретениеТоваровУслуг КАК ПоступлениеТоваровНаСклад
		                  |ГДЕ
		                  |	ПоступлениеТоваровНаСклад.ЗаказПоставщику = &ЗаказПоставщику
		                  |	И ПоступлениеТоваровНаСклад.Проведен" ;
		 
		 Пустой = Запрос.Выполнить().Пустой();
		 Если НЕ Пустой Тогда
		 
		 	 Возврат Истина
			 
		 Иначе
			 Возврат Ложь;
		 
		 КонецЕсли; 
 
	 КонецФункции //      
	 
	 
	 
	 
	 
	 
	 
	 Функция СоздатьСотрудникаИзФизическогоЛица(ФизическоеЛицоСсылка) Экспорт

	// Проверка входных параметров
	Если НЕ ЗначениеЗаполнено(ФизическоеЛицоСсылка) Тогда
		Сообщить("Ошибка: Не указано физическое лицо!");
		Возврат Неопределено;
	КонецЕсли;

	// Проверяем, существует ли уже сотрудник для данного физического лица
	СуществующийСотрудник = НайтиСотрудникаПоФизическомуЛицу(ФизическоеЛицоСсылка);

	Если ЗначениеЗаполнено(СуществующийСотрудник) Тогда
		Возврат СуществующийСотрудник;
	КонецЕсли;

	// Создаем нового сотрудника
	Попытка
		НовыйСотрудник = Справочники.Сотрудники.СоздатьЭлемент();

		// Заполняем основные реквизиты
		НовыйСотрудник.ФизическоеЛицо = ФизическоеЛицоСсылка;
		НовыйСотрудник.Наименование = Строка(ФизическоеЛицоСсылка);

		// Заполняем организацию, если указана
		НовыйСотрудник.ГоловнаяОрганизация = А_ПолучитьОрганизациюУпр();

		// Записываем элемент
		НовыйСотрудник.Записать();

		Возврат НовыйСотрудник.Ссылка;

	Исключение
		Сообщить("Ошибка при создании сотрудника: " + ОписаниеОшибки());
		Возврат Неопределено;
	КонецПопытки;

КонецФункции

// Ищет сотрудника по физическому лицу
//
// Параметры:
//   ФизическоеЛицоСсылка - СправочникСсылка.ФизическиеЛица - ссылка на физическое лицо
//
// Возвращаемое значение:
//   СправочникСсылка.Сотрудники - найденный сотрудник или пустая ссылка
//
Функция НайтиСотрудникаПоФизическомуЛицу(ФизическоеЛицоСсылка) Экспорт

	Запрос = Новый Запрос;
	Запрос.Текст =
		"ВЫБРАТЬ ПЕРВЫЕ 1
		|	Сотрудники.Ссылка КАК Ссылка
		|ИЗ
		|	Справочник.Сотрудники КАК Сотрудники
		|ГДЕ
		|	Сотрудники.ФизическоеЛицо = &ФизическоеЛицо
		|	";

	Запрос.УстановитьПараметр("ФизическоеЛицо", ФизическоеЛицоСсылка);

	Результат = Запрос.Выполнить();

	Если Результат.Пустой() Тогда
		Возврат Справочники.Сотрудники.ПустаяСсылка();
	Иначе
		Выборка = Результат.Выбрать();
		Выборка.Следующий();
		Возврат Выборка.Ссылка;
	КонецЕсли;

КонецФункции

	 
	 
	 
	 