#Если Сервер Или ТолстыйКлиентОбычноеПриложение Или ВнешнееСоединение Тогда

#Область Печать

// Сформировать печатные формы объектов
//
// Параметры:
// 		МассивОбъектов - Массив - Массив ссылок на объекты которые нужно распечатать
// 		ПараметрыПечати - Структура - Структура дополнительных параметров печати
// 		КоллекцияПечатныхФорм - Таблица значений - Сформированные табличные документы
// 		ОбъектыПечати - Объекты печати
// 		ПараметрыВывода - Структура - Параметры сформированных табличных документов.
//
Процедура Печать(МассивОбъектов, ПараметрыПечати, КоллекцияПечатныхФорм, ОбъектыПечати, ПараметрыВывода) Экспорт
		
	ПараметрыВывода.ДоступнаПечатьПоКомплектно = Истина;
	СтруктураТипов = ОбщегоНазначенияУТ.СоответствиеМассивовПоТипамОбъектов(МассивОбъектов);
	Для Каждого СтруктураОбъектов Из СтруктураТипов Цикл	
		
		Если УправлениеПечатью.НужноПечататьМакет(КоллекцияПечатныхФорм, "АктВводаОСБюдж") Тогда
		    ИмяМакета = "";
			УправлениеПечатью.ВывестиТабличныйДокументВКоллекцию(
				КоллекцияПечатныхФорм,
				"АктВводаОСБюдж",
				НСтр("ru='Акт ввода в эксплуатацию основных средств';uk='Акт введення в експлуатацію основних засобів'"),
				СформироватьПечатнуюФормуАктВводаОС(
					МассивОбъектов,
					ОбъектыПечати,
					ПараметрыПечати,
					ИмяМакета),, ИмяМакета);
		
		КонецЕсли;  
				
		Если УправлениеПечатью.НужноПечататьМакет(КоллекцияПечатныхФорм, "АктПеремещениеОСБюдж") Тогда
		    ИмяМакета = "";
			УправлениеПечатью.ВывестиТабличныйДокументВКоллекцию(
				КоллекцияПечатныхФорм,
				"АктПеремещениеОСБюдж",
				НСтр("ru='Акт внутреннего перемещения основных средств';uk='Акт внутрішнього переміщення основних засобів'"),
				СформироватьПечатнуюФормуАктПеремещенияОС(
					МассивОбъектов,
					ОбъектыПечати,
					ПараметрыПечати,
					ИмяМакета),, ИмяМакета);
		
		КонецЕсли;
		
		Если УправлениеПечатью.НужноПечататьМакет(КоллекцияПечатныхФорм, "АктПриемаПередачиОСБюдж") Тогда
		    ИмяМакета = "";
			УправлениеПечатью.ВывестиТабличныйДокументВКоллекцию(
				КоллекцияПечатныхФорм,
				"АктПриемаПередачиОСБюдж",
				НСтр("ru='Акт приема-передачи основных средств';uk='Акт прийому-передачі основних засобів'"),
				СформироватьПечатнуюФормуАктПриемаПередачиОС(
					МассивОбъектов,
					ОбъектыПечати,
					ПараметрыПечати,
					ИмяМакета),, ИмяМакета);
		
		КонецЕсли;   
								
		Если УправлениеПечатью.НужноПечататьМакет(КоллекцияПечатныхФорм, "АктПеремещениеОСМАБюдж") Тогда
		    ИмяМакета = "";
			УправлениеПечатью.ВывестиТабличныйДокументВКоллекцию(
				КоллекцияПечатныхФорм,
				"АктПеремещениеОСМАБюдж",
				НСтр("ru='Акт внутреннего перемещения основных средств';uk='Акт внутрішнього переміщення основних засобів'"),
				СформироватьПечатнуюФормуАктПеремещенияОСМА(
					МассивОбъектов,
					ОбъектыПечати,
					ПараметрыПечати,
					ИмяМакета),, ИмяМакета);
		
		КонецЕсли;   
								
		Если УправлениеПечатью.НужноПечататьМакет(КоллекцияПечатныхФорм, "АктПриемаРемонтБюдж") Тогда
		    ИмяМакета = "";
			УправлениеПечатью.ВывестиТабличныйДокументВКоллекцию(
				КоллекцияПечатныхФорм,
				"АктПриемаРемонтБюдж",
				НСтр("ru='Акт внутреннего перемещения основных средств';uk='Акт внутрішнього переміщення основних засобів'"),
				СформироватьПечатнуюФормуАктПриемаРемонтОС(
					МассивОбъектов,
					ОбъектыПечати,
					ПараметрыПечати,
					ИмяМакета),, ИмяМакета);
		
		КонецЕсли;   
								
		Если УправлениеПечатью.НужноПечататьМакет(КоллекцияПечатныхФорм, "АктСписанияОСБюдж") Тогда
		    ИмяМакета = "";
			УправлениеПечатью.ВывестиТабличныйДокументВКоллекцию(
				КоллекцияПечатныхФорм,
				"АктСписанияОСБюдж",
				НСтр("ru='Акт списания основных средств (частичной ликвидации)';uk='Акт списання основних засобів (часткової ліквідації)'"),
				СформироватьПечатнуюФормуАктСписанияОС(
					МассивОбъектов,
					ОбъектыПечати,
					ПараметрыПечати,
					ИмяМакета),, ИмяМакета);
		
		КонецЕсли;   
								
		Если УправлениеПечатью.НужноПечататьМакет(КоллекцияПечатныхФорм, "АктСписанияОСГруппаБюдж") Тогда
		    ИмяМакета = "";
			УправлениеПечатью.ВывестиТабличныйДокументВКоллекцию(
				КоллекцияПечатныхФорм,
				"АктСписанияОСГруппаБюдж",
				НСтр("ru='Акт списания группы основных средств';uk='Акт списання групи основних засобів'"),
				СформироватьПечатнуюФормуАктСписанияГруппаОС(
					МассивОбъектов,
					ОбъектыПечати,
					ПараметрыПечати,
					ИмяМакета),, ИмяМакета);
		
		КонецЕсли;   
								
	КонецЦикла;

КонецПроцедуры

Функция СформироватьПечатнуюФормуАктВводаОС(МассивОбъектов, ОбъектыПечати, ПараметрыПечати, ИмяМакета)
	
	УстановитьПривилегированныйРежим(Истина);
	
	СтруктураТипов = ОбщегоНазначенияУТ.СоответствиеМассивовПоТипамОбъектов(МассивОбъектов);
	
	ТабличныйДокумент = Новый ТабличныйДокумент;

	ТабличныйДокумент.ИмяПараметровПечати = "ПАРАМЕТРЫ_ПЕЧАТИ_АктВводаОС";
	
	НомерТипаДокумента = 0;
	
	СведенияАктуальны = Истина;
		
	Для Каждого СтруктураОбъектов Из СтруктураТипов Цикл
				
		МенеджерОбъекта = ОбщегоНазначения.МенеджерОбъектаПоПолномуИмени(СтруктураОбъектов.Ключ); 
				
		Для Каждого Элемент Из СтруктураОбъектов.Значение Цикл
			
			НомерТипаДокумента = НомерТипаДокумента + 1;
			Если НомерТипаДокумента > 1 Тогда                          	
				ТабличныйДокумент.ВывестиГоризонтальныйРазделительСтраниц();
			КонецЕсли;

			ДанныеДляПечати = МенеджерОбъекта.ПолучитьДанныеДляПечатнойФормыАктВводаОС_2016(ПараметрыПечати, Элемент.Ссылка);
 	        НомерСтрокиНачало = ТабличныйДокумент.ВысотаТаблицы + 1;
			
			ЗаполнитьМакетАктВводаОС(ТабличныйДокумент, ДанныеДляПечати, ОбъектыПечати, СведенияАктуальны, Элемент.Ссылка);
			
			// В табличном документе зададим имя области, в которую был 
			// выведен объект. Нужно для возможности печати покомплектно.
			УправлениеПечатью.ЗадатьОбластьПечатиДокумента(ТабличныйДокумент, 
			НомерСтрокиНачало, ОбъектыПечати, Элемент.Ссылка); 			
			
		КонецЦикла;
		
	КонецЦикла;
	
	Возврат ТабличныйДокумент;
	
КонецФункции

Процедура ЗаполнитьМакетАктВводаОС(ТабличныйДокумент, ВыборкаПоДокументам, ОбъектыПечати, СведенияАктуальны, Ссылка)
	
	Макет = УправлениеПечатью.МакетПечатнойФормы("Обработка.ПечатьФормОСБюджет.ПФ_MXL_АктВводаОСБюдж_2016");

	ВыборкаПоШапке  = ВыборкаПоДокументам.ВыборкаПоШапке.Выбрать();		
	ВыборкаПоШапке.Следующий();
	ВыборкаПоОС		= ВыборкаПоДокументам.ВыборкаПоОС.Выбрать();
	ВыборкаБУ 		= ВыборкаПоДокументам.ВыборкаБУ.Выбрать();		
	
	ВыборкаПоКомиссии = ОбщегоНазначенияБПВызовСервера.ПолучитьСведенияОКомиссии(Ссылка);
	ОтветственныеЛица = ОтветственныеЛицаБП.ОтветственныеЛица(Ссылка.Организация, Ссылка.Дата);  
	
	ОбластьМакета = Макет.ПолучитьОбласть("Шапка");
	Параметры     = ОбластьМакета.Параметры;   
	Параметры.Заполнить(ВыборкаПоШапке);
	СведенияОбОрганизации	= ФормированиеПечатныхФорм.СведенияОЮрФизЛице(ВыборкаПоШапке.Организация, Ссылка.Дата);	
	Параметры.Организация	= ФормированиеПечатныхФорм.ОписаниеОрганизации(СведенияОбОрганизации, "ПолноеНаименование,");
	Параметры.ЕДРПОУ		= СведенияОбОрганизации.КодПоЕДРПОУ;		
	Параметры.Должность_Руководитель = ОтветственныеЛица.РуководительДолжностьПредставление;
	Параметры.ФИО_Руководитель		 = ОтветственныеЛица.РуководительПредставление;
	Параметры.ДатаАктаПрописью		 = Формат(ВыборкаПоШапке.ДатаАкта, "ДЛФ=DD");
	
	ТабличныйДокумент.Вывести(ОбластьМакета); 
	
	ОбластьМакета = Макет.ПолучитьОбласть("Строка");
	Параметры     = ОбластьМакета.Параметры;
	
	СуммаВсего = 0;
	КоличествоВсего = 0;
	НаименованияОбъектов = "";
	Пока ВыборкаПоОС.Следующий() Цикл
		
		Параметры.Заполнить(ВыборкаПоОС);			
		Параметры.Количество  = 1;  
		Параметры.ЛиквидационнаяСтоимость = Формат(ВыборкаПоОС.ЛиквидационнаяСтоимость, "ЧЦ=15; ЧДЦ=2; ЧН=");   
		Параметры.Сумма					  = ВыборкаПоОС.ПервоначальнаяСтоимость;
		Параметры.ДатаВыпуска			  = Формат(ВыборкаПоОС.ДатаВыпуска, "ДЛФ=Д");
		СуммаВсего						  = СуммаВсего + ВыборкаПоОС.ПервоначальнаяСтоимость;
		КоличествоВсего 	 			  = КоличествоВсего + 1;  
		НаименованияОбъектов 			  = НаименованияОбъектов + СокрЛП(ВыборкаПоОС.НаименованиеОС) + " № " + СокрЛП(ВыборкаПоОС.ИнвентарныйНомер) + ", ";
		
		ТабличныйДокумент.Вывести(ОбластьМакета);
		
	КонецЦикла;
	
	ОбластьМакета 				 	= Макет.ПолучитьОбласть("Подвал");
	Параметры     				 	= ОбластьМакета.Параметры;
	Параметры.СуммаИзносаВсего		= 0;
	Параметры.СуммаВсего 	 	 	= СуммаВсего;
	Параметры.КоличествоВсего 		= КоличествоВсего;
	Параметры.НаименованияОбъектов  = Лев(НаименованияОбъектов, СтрДлина(НаименованияОбъектов)-2);
	
	Параметры.Заполнить(ВыборкаПоШапке);
	Параметры.Заполнить(ВыборкаПоКомиссии);
	
	ОсновныеСотрудникиФизическихЛицПринял = КадровыйУчет.ОсновныеСотрудникиФизическихЛиц(ВыборкаПоШапке.Принял, Истина, Ссылка.Организация, Ссылка.Дата);
	Если ЗначениеЗаполнено(ОсновныеСотрудникиФизическихЛицПринял) Тогда
		Для каждого Строка Из ОсновныеСотрудникиФизическихЛицПринял Цикл
			ДанныеФизЛицаПолучил = КадровыйУчет.КадровыеДанныеСотрудников(Истина, Строка.Сотрудник, "Должность", Ссылка.Дата);			
		КонецЦикла;
		Для каждого СтрокаДанныеПолучил Из ДанныеФизЛицаПолучил Цикл			
			ОбластьМакета.Параметры.ПолучилДолжность= СтрокаДанныеПолучил.Должность;
			ОбластьМакета.Параметры.ПолучилФИО 		= СтрокаДанныеПолучил.ФизическоеЛицо;			
		КонецЦикла;
	КонецЕсли;
	
	ТабличныйДокумент.Вывести(ОбластьМакета);
	
	ОбластьМакета = Макет.ПолучитьОбласть("ДанныеБУСтрока");
	Параметры     = ОбластьМакета.Параметры;
	Если Ссылка.Проведен Тогда
		Пока ВыборкаБУ.Следующий() Цикл 
			Параметры.Заполнить(ВыборкаБУ); 
			Параметры.СчетКт = ?(ВыборкаБУ.СчетКт = ПланыСчетов.Хозрасчетный.ПустаяСсылка(), "-", ВыборкаБУ.СчетКт);
			Параметры.СчетДт = ?(ВыборкаБУ.СчетДт = ПланыСчетов.Хозрасчетный.ПустаяСсылка(), "-", ВыборкаБУ.СчетДт);
			ТабличныйДокумент.Вывести(ОбластьМакета);    
		КонецЦикла;
	Иначе
		ТабличныйДокумент.Вывести(ОбластьМакета);       
	КонецЕсли;
	
	ОбластьМакета = Макет.ПолучитьОбласть("ДанныеБУПодвал");
	Параметры     = ОбластьМакета.Параметры;
	Параметры.ОтветственныйДолжность = ДолжностиДляПечатиКлиентСервер.ДолжностьФизическогоЛица(Ссылка.Ответственный.ФизическоеЛицо, Ссылка.Организация, Ссылка.Дата);;
	Параметры.ОтветственныйФИО 		 = ФизическиеЛицаУТ.ФамилияИнициалыФизЛица(Ссылка.Ответственный.ФизическоеЛицо,Ссылка.Дата);			
	Параметры.ГлавныйБухгалтер 	 	 = ОтветственныеЛица.ГлавныйБухгалтерПредставление;
	
	ТабличныйДокумент.Вывести(ОбластьМакета);
	
КонецПроцедуры

Функция СформироватьПечатнуюФормуАктПеремещенияОС(МассивОбъектов, ОбъектыПечати, ПараметрыПечати, ИмяМакета)
	
	УстановитьПривилегированныйРежим(Истина);
	
	СтруктураТипов = ОбщегоНазначенияУТ.СоответствиеМассивовПоТипамОбъектов(МассивОбъектов);
	
	ТабличныйДокумент = Новый ТабличныйДокумент;

	ТабличныйДокумент.ИмяПараметровПечати = "ПАРАМЕТРЫ_ПЕЧАТИ_АктПеремещенияОС";
	
	НомерТипаДокумента = 0;
	
	СведенияАктуальны = Истина;
		
	Для Каждого СтруктураОбъектов Из СтруктураТипов Цикл
				
		МенеджерОбъекта = ОбщегоНазначения.МенеджерОбъектаПоПолномуИмени(СтруктураОбъектов.Ключ); 
				
		Для Каждого Элемент Из СтруктураОбъектов.Значение Цикл
			
			НомерТипаДокумента = НомерТипаДокумента + 1;
			Если НомерТипаДокумента > 1 Тогда                          	
				ТабличныйДокумент.ВывестиГоризонтальныйРазделительСтраниц();
			КонецЕсли;

			ДанныеДляПечати = МенеджерОбъекта.ПолучитьДанныеДляПечатнойФормыАктПеремещениеОС_2016(ПараметрыПечати, Элемент.Ссылка);
 	        НомерСтрокиНачало = ТабличныйДокумент.ВысотаТаблицы + 1;
			
			ЗаполнитьМакетАктПеремещенияОС(ТабличныйДокумент, ДанныеДляПечати, ОбъектыПечати, СведенияАктуальны, Элемент.Ссылка);
			
			// В табличном документе зададим имя области, в которую был 
			// выведен объект. Нужно для возможности печати покомплектно.
			УправлениеПечатью.ЗадатьОбластьПечатиДокумента(ТабличныйДокумент, 
			НомерСтрокиНачало, ОбъектыПечати, Элемент.Ссылка); 			
			
		КонецЦикла;
		
	КонецЦикла;
	
	Возврат ТабличныйДокумент;
	
КонецФункции

Процедура ЗаполнитьМакетАктПеремещенияОС(ТабличныйДокумент, ВыборкаПоДокументам, ОбъектыПечати, СведенияАктуальны, Ссылка)
	
	Макет = УправлениеПечатью.МакетПечатнойФормы("Обработка.ПечатьФормОСБюджет.ПФ_MXL_АктВнутреннегоПеремещенияОСБюдж_2016");

	ВыборкаПоШапке  = ВыборкаПоДокументам.ВыборкаПоШапке.Выбрать();		
	ВыборкаПоШапке.Следующий();
	ВыборкаПоОС		= ВыборкаПоДокументам.ВыборкаПоОС.Выбрать();
	
	ОтветственныеЛица = ОтветственныеЛицаБП.ОтветственныеЛица(Ссылка.Организация, Ссылка.Дата);  
	
	ОбластьМакета = Макет.ПолучитьОбласть("Шапка");
	Параметры     = ОбластьМакета.Параметры;
	Параметры.Заполнить(ВыборкаПоШапке);
	СведенияОбОрганизации	= ФормированиеПечатныхФорм.СведенияОЮрФизЛице(ВыборкаПоШапке.Организация, Ссылка.Дата);	
	Параметры.Организация	= ФормированиеПечатныхФорм.ОписаниеОрганизации(СведенияОбОрганизации, "ПолноеНаименование,");
	Параметры.ЕДРПОУ		= СведенияОбОрганизации.КодПоЕДРПОУ;		
	Параметры.ДатаАктаПрописью		 = Формат(ВыборкаПоШапке.ДатаАкта, "ДЛФ=DD");
	ТабличныйДокумент.Вывести(ОбластьМакета); 
	
	ОбластьМакета = Макет.ПолучитьОбласть("Строка");
	Параметры     = ОбластьМакета.Параметры;
	
	СуммаВсего = 0;
	КоличествоВсего = 0;
	Пока ВыборкаПоОС.Следующий() Цикл
		Параметры.Заполнить(ВыборкаПоОС);			
		Параметры.Количество  = 1;  
		Параметры.Цена		 = ВыборкаПоОС.ПервоначальнаяСтоимость;
		Параметры.Сумма 	  = ВыборкаПоОС.ПервоначальнаяСтоимость;
		СуммаВсего 			  = СуммаВсего + ВыборкаПоОС.ПервоначальнаяСтоимость;
		КоличествоВсего 	  = КоличествоВсего + 1;  
		ТабличныйДокумент.Вывести(ОбластьМакета);
	КонецЦикла;
	
	ОбластьМакета 				 	= Макет.ПолучитьОбласть("Подвал");
	Параметры     				 	= ОбластьМакета.Параметры;
	Параметры.Заполнить(ВыборкаПоШапке);
	Параметры.СуммаВсего 	 	 	= СуммаВсего;
	Параметры.КоличествоВсего 		= КоличествоВсего;
	
	ОсновныеСотрудникиФизическихЛицПринял = КадровыйУчет.ОсновныеСотрудникиФизическихЛиц(ВыборкаПоШапке.Принял, Истина, Ссылка.Организация, Ссылка.Дата);
	Если ЗначениеЗаполнено(ОсновныеСотрудникиФизическихЛицПринял) Тогда
		Для каждого Строка Из ОсновныеСотрудникиФизическихЛицПринял Цикл
			ДанныеФизЛицаПолучил = КадровыйУчет.КадровыеДанныеСотрудников(Истина, Строка.Сотрудник, "Должность", Ссылка.Дата);			
		КонецЦикла;
		Для каждого СтрокаДанныеПолучил Из ДанныеФизЛицаПолучил Цикл			
			ОбластьМакета.Параметры.ПолучилДолжность= СтрокаДанныеПолучил.Должность;
			ОбластьМакета.Параметры.ПолучилФИО 		= СтрокаДанныеПолучил.ФизическоеЛицо;			
		КонецЦикла;
	КонецЕсли;
	
	ОсновныеСотрудникиФизическихЛицСдал = КадровыйУчет.ОсновныеСотрудникиФизическихЛиц(ВыборкаПоШапке.Сдал, Истина, Ссылка.Организация, Ссылка.Дата);
	Если ЗначениеЗаполнено(ОсновныеСотрудникиФизическихЛицСдал) Тогда		
		Для каждого Строка Из ОсновныеСотрудникиФизическихЛицСдал Цикл
			ДанныеФизЛицаСдал = КадровыйУчет.КадровыеДанныеСотрудников(Истина, Строка.Сотрудник, "Должность", Ссылка.Дата);
		КонецЦикла;
		Для каждого СтрокаДанныеСдал Из ДанныеФизЛицаСдал Цикл
			ОбластьМакета.Параметры.СдалДолжность 	= СтрокаДанныеСдал.Должность;
			ОбластьМакета.Параметры.СдалФИО	 		= СтрокаДанныеСдал.ФизическоеЛицо;
		КонецЦикла;			
	КонецЕсли;       
	
	Параметры.ГлавныйБухгалтер 	 	 = ОтветственныеЛица.ГлавныйБухгалтерПредставление;
	
	ТабличныйДокумент.Вывести(ОбластьМакета);
	
КонецПроцедуры

Функция СформироватьПечатнуюФормуАктПеремещенияОСМА(МассивОбъектов, ОбъектыПечати, ПараметрыПечати, ИмяМакета)
	
	УстановитьПривилегированныйРежим(Истина);
	
	СтруктураТипов = ОбщегоНазначенияУТ.СоответствиеМассивовПоТипамОбъектов(МассивОбъектов);
	
	ТабличныйДокумент = Новый ТабличныйДокумент;

	ТабличныйДокумент.ИмяПараметровПечати = "ПАРАМЕТРЫ_ПЕЧАТИ_АктПеремещенияОСМА";
	
	НомерТипаДокумента = 0;
	
	СведенияАктуальны = Истина;
		
	Для Каждого СтруктураОбъектов Из СтруктураТипов Цикл
				
		МенеджерОбъекта = ОбщегоНазначения.МенеджерОбъектаПоПолномуИмени(СтруктураОбъектов.Ключ); 
				
		Для Каждого Элемент Из СтруктураОбъектов.Значение Цикл
			
			НомерТипаДокумента = НомерТипаДокумента + 1;
			Если НомерТипаДокумента > 1 Тогда                          	
				ТабличныйДокумент.ВывестиГоризонтальныйРазделительСтраниц();
			КонецЕсли;

			ДанныеДляПечати = МенеджерОбъекта.ПолучитьДанныеДляПечатнойФормыАктПеремещениеОСМА_2016(ПараметрыПечати, Элемент.Ссылка);
 	        НомерСтрокиНачало = ТабличныйДокумент.ВысотаТаблицы + 1;
			
			ЗаполнитьМакетАктПеремещенияОСМА(ТабличныйДокумент, ДанныеДляПечати, ОбъектыПечати, СведенияАктуальны, Элемент.Ссылка);
			
			// В табличном документе зададим имя области, в которую был 
			// выведен объект. Нужно для возможности печати покомплектно.
			УправлениеПечатью.ЗадатьОбластьПечатиДокумента(ТабличныйДокумент, 
			НомерСтрокиНачало, ОбъектыПечати, Элемент.Ссылка); 			
			
		КонецЦикла;
		
	КонецЦикла;
	
	Возврат ТабличныйДокумент;
	
КонецФункции

Процедура ЗаполнитьМакетАктПеремещенияОСМА(ТабличныйДокумент, ВыборкаПоДокументам, ОбъектыПечати, СведенияАктуальны, Ссылка)
	
	Макет = УправлениеПечатью.МакетПечатнойФормы("Обработка.ПечатьФормОСБюджет.ПФ_MXL_АктВнутреннегоПеремещенияОСБюдж_2016");

	ВыборкаПоШапке = ВыборкаПоДокументам.ВыборкаПоШапке.Выбрать();
	ВыборкаПоШапке.Следующий();
	
	ОтветственныеЛица = ОтветственныеЛицаБП.ОтветственныеЛица(Ссылка.Организация, Ссылка.Дата);  
	СведенияОбОрганизации	= ФормированиеПечатныхФорм.СведенияОЮрФизЛице(ВыборкаПоШапке.Организация, Ссылка.Дата);	
	
	НеПервая = Ложь;           
	
	ВыборкаПоМОЛСдал = ВыборкаПоДокументам.ВыборкаПоОС.Выбрать(ОбходРезультатаЗапроса.ПоГруппировкам);  
	
	Пока ВыборкаПоМОЛСдал.Следующий() Цикл   
		
			ВыборкаПоМОЛПринял = ВыборкаПоМОЛСдал.Выбрать(ОбходРезультатаЗапроса.ПоГруппировкам);
			Пока ВыборкаПоМОЛПринял.Следующий() Цикл
				
				Если НеПервая Тогда
					
					ТабличныйДокумент.ВывестиГоризонтальныйРазделительСтраниц();
					
				КонецЕсли;

				ОбластьМакета = Макет.ПолучитьОбласть("Шапка");
				Параметры     = ОбластьМакета.Параметры;
				Параметры.Заполнить(ВыборкаПоШапке);
				Параметры.Организация	= ФормированиеПечатныхФорм.ОписаниеОрганизации(СведенияОбОрганизации, "ПолноеНаименование,");
				Параметры.ЕДРПОУ		= СведенияОбОрганизации.КодПоЕДРПОУ;		
				Параметры.ДатаАктаПрописью		 = Формат(ВыборкаПоШапке.ДатаАкта, "ДЛФ=DD");
				ТабличныйДокумент.Вывести(ОбластьМакета); 
				
				ОбластьМакета = Макет.ПолучитьОбласть("Строка");
				Параметры     = ОбластьМакета.Параметры;
				
				СуммаВсего = 0;
				КоличествоВсего = 0;
				ВыборкаПоОС = ВыборкаПоМОЛПринял.Выбрать();    			
				Пока ВыборкаПоОС.Следующий() Цикл
					Параметры.Заполнить(ВыборкаПоОС);			
					Параметры.НаименованиеОС 	= НоменклатураКлиентСервер.ПредставлениеНоменклатурыДляПечати(ВыборкаПоОС.НоменклатураНаименование, ВыборкаПоОС.ХарактеристикаНаименование);
					Параметры.ЕдиницаИзмерения  = ВыборкаПоОС.Номенклатура.ЕдиницаИзмерения;  
					Параметры.Количество 		= 1;  
					Параметры.Цена		 		= ВыборкаПоОС.ПервоначальнаяСтоимость;
					Параметры.Сумма 	  		= ВыборкаПоОС.ПервоначальнаяСтоимость;
					СуммаВсего 			  		= СуммаВсего + ВыборкаПоОС.ПервоначальнаяСтоимость;
					КоличествоВсего 	  		= КоличествоВсего + 1;  
					ТабличныйДокумент.Вывести(ОбластьМакета);
				КонецЦикла;
				
				ОбластьМакета 				 	= Макет.ПолучитьОбласть("Подвал");
				Параметры     				 	= ОбластьМакета.Параметры;
				Параметры.Заполнить(ВыборкаПоШапке);
				Параметры.СуммаВсего 	 	 	= СуммаВсего;
				Параметры.КоличествоВсего 		= КоличествоВсего;
				
				ОсновныеСотрудникиФизическихЛицПринял = КадровыйУчет.ОсновныеСотрудникиФизическихЛиц(ВыборкаПоМОЛПринял.Принял, Истина, Ссылка.Организация, Ссылка.Дата);
				Если ЗначениеЗаполнено(ОсновныеСотрудникиФизическихЛицПринял) Тогда
					Для каждого Строка Из ОсновныеСотрудникиФизическихЛицПринял Цикл
						ДанныеФизЛицаПолучил = КадровыйУчет.КадровыеДанныеСотрудников(Истина, Строка.Сотрудник, "Должность", Ссылка.Дата);			
					КонецЦикла;
					Для каждого СтрокаДанныеПолучил Из ДанныеФизЛицаПолучил Цикл			
						ОбластьМакета.Параметры.ПолучилДолжность= СтрокаДанныеПолучил.Должность;
						ОбластьМакета.Параметры.ПолучилФИО 		= СтрокаДанныеПолучил.ФизическоеЛицо;			
					КонецЦикла;
				КонецЕсли;
				
				ОсновныеСотрудникиФизическихЛицСдал = КадровыйУчет.ОсновныеСотрудникиФизическихЛиц(ВыборкаПоМОЛПринял.Сдал, Истина, Ссылка.Организация, Ссылка.Дата);
				Если ЗначениеЗаполнено(ОсновныеСотрудникиФизическихЛицСдал) Тогда		
					Для каждого Строка Из ОсновныеСотрудникиФизическихЛицСдал Цикл
						ДанныеФизЛицаСдал = КадровыйУчет.КадровыеДанныеСотрудников(Истина, Строка.Сотрудник, "Должность", Ссылка.Дата);
					КонецЦикла;
					Для каждого СтрокаДанныеСдал Из ДанныеФизЛицаСдал Цикл
						ОбластьМакета.Параметры.СдалДолжность 	= СтрокаДанныеСдал.Должность;
						ОбластьМакета.Параметры.СдалФИО	 		= СтрокаДанныеСдал.ФизическоеЛицо;
					КонецЦикла;			
				КонецЕсли;       
				
				Параметры.ГлавныйБухгалтер 	 	 = ОтветственныеЛица.ГлавныйБухгалтерПредставление;
				
				ТабличныйДокумент.Вывести(ОбластьМакета);  
				
			КонецЦикла;		
			
		КонецЦикла;			
	
КонецПроцедуры

Функция СформироватьПечатнуюФормуАктПриемаПередачиОС(МассивОбъектов, ОбъектыПечати, ПараметрыПечати, ИмяМакета)
	
	УстановитьПривилегированныйРежим(Истина);
	
	СтруктураТипов = ОбщегоНазначенияУТ.СоответствиеМассивовПоТипамОбъектов(МассивОбъектов);
	
	ТабличныйДокумент = Новый ТабличныйДокумент;
	
	ТабличныйДокумент.ИмяПараметровПечати = "ПАРАМЕТРЫ_ПЕЧАТИ_АктПриемаПередачиОС";
	
	НомерТипаДокумента = 0;
	
	СведенияАктуальны = Истина;
	
	Для Каждого СтруктураОбъектов Из СтруктураТипов Цикл
		
		МенеджерОбъекта = ОбщегоНазначения.МенеджерОбъектаПоПолномуИмени(СтруктураОбъектов.Ключ); 
		
		Для Каждого Элемент Из СтруктураОбъектов.Значение Цикл
			
			НомерТипаДокумента = НомерТипаДокумента + 1;
			Если НомерТипаДокумента > 1 Тогда                          	
				ТабличныйДокумент.ВывестиГоризонтальныйРазделительСтраниц();
			КонецЕсли;
			
			ДанныеДляПечати = МенеджерОбъекта.ПолучитьДанныеДляПечатнойАктПриемаПередачиОС_2016(ПараметрыПечати, Элемент.Ссылка);
			НомерСтрокиНачало = ТабличныйДокумент.ВысотаТаблицы + 1;
			
			ЗаполнитьМакетАктПриемаПередачиОС(ТабличныйДокумент, ДанныеДляПечати, ОбъектыПечати, СведенияАктуальны, Элемент.Ссылка);
			
			// В табличном документе зададим имя области, в которую был 
			// выведен объект. Нужно для возможности печати покомплектно.
			УправлениеПечатью.ЗадатьОбластьПечатиДокумента(ТабличныйДокумент, 
			НомерСтрокиНачало, ОбъектыПечати, Элемент.Ссылка); 			
			
		КонецЦикла;
		
	КонецЦикла;
	
	Возврат ТабличныйДокумент;
	
КонецФункции

Процедура ЗаполнитьМакетАктПриемаПередачиОС(ТабличныйДокумент, ВыборкаПоДокументам, ОбъектыПечати, СведенияАктуальны, Ссылка)
	
	Макет = УправлениеПечатью.МакетПечатнойФормы("Обработка.ПечатьФормОСБюджет.ПФ_MXL_АктПриемаПередачиОСБюдж_2016");
	
	ВыборкаПоШапке  = ВыборкаПоДокументам.ВыборкаПоШапке.Выбрать();		
	ВыборкаПоШапке.Следующий();
	СписокМОЛ = ВыборкаПоДокументам.ВыборкаПоОС.Выгрузить();
	СписокМОЛ.Свернуть("МОЛ, МестоХранения");
	ВыборкаПоМОЛ	= ВыборкаПоДокументам.ВыборкаПоОС.Выбрать(ОбходРезультатаЗапроса.ПоГруппировкам);
	ВыборкаБУ 		= ВыборкаПоДокументам.ВыборкаБУ.Выбрать();		
	
	ВыборкаПоКомиссии = ОбщегоНазначенияБПВызовСервера.ПолучитьСведенияОКомиссии(Ссылка);	
	СведенияОбОрганизации	= ФормированиеПечатныхФорм.СведенияОЮрФизЛице(ВыборкаПоШапке.Организация, Ссылка.Дата);	
	ОтветственныеЛица = ОтветственныеЛицаБП.ОтветственныеЛица(Ссылка.Организация, Ссылка.Дата);  
	
	НеПервая = Ложь;
	Пока ВыборкаПоМОЛ.Следующий() Цикл      
		
		ВыборкаПоМестаХранения = ВыборкаПоМОЛ.Выбрать(ОбходРезультатаЗапроса.ПоГруппировкам);   
		Пока ВыборкаПоМестаХранения.Следующий() Цикл
			
			Если НеПервая Тогда
				ТабличныйДокумент.ВывестиГоризонтальныйРазделительСтраниц();
			КонецЕсли;      
			
			ОбластьМакета = Макет.ПолучитьОбласть("Шапка");
			Параметры     = ОбластьМакета.Параметры;
			Параметры.Заполнить(ВыборкаПоШапке);
			Параметры.Организация	= ФормированиеПечатныхФорм.ОписаниеОрганизации(СведенияОбОрганизации, "ПолноеНаименование,");
			Параметры.ЕДРПОУ		= СведенияОбОрганизации.КодПоЕДРПОУ;		
			Параметры.Должность_Руководитель = ОтветственныеЛица.РуководительДолжностьПредставление;
			Параметры.ФИО_Руководитель		 = ОтветственныеЛица.РуководительПредставление;
			Параметры.ДатаАктаПрописью		 = Формат(ВыборкаПоШапке.ДатаАкта, "ДЛФ=DD");
			ТабличныйДокумент.Вывести(ОбластьМакета); 
			
			ОбластьМакета = Макет.ПолучитьОбласть("Строка");
			Параметры     = ОбластьМакета.Параметры;
			
			ВыборкаПоОС = ВыборкаПоМестаХранения.Выбрать();   
			СуммаВсего = 0;
			СуммаИзносВсего = 0;
			КоличествоВсего = 0;
			НаименованияОбъектов = "";
			Пока ВыборкаПоОС.Следующий() Цикл
				
				Параметры.Заполнить(ВыборкаПоОС);			
				Параметры.Заполнить(ВыборкаПоШапке);
				Параметры.Количество  = 1;  
				Параметры.Сумма 	  = ВыборкаПоОС.ПервоначальнаяСтоимость;
				Параметры.СуммаИзноса = ВыборкаПоОС.Износ;
				Параметры.ГодВыпуска  = Формат(ВыборкаПоОС.ГодВыпуска, "ДФ=yyyy");
				СуммаВсего 			  = СуммаВсего + ВыборкаПоОС.ПервоначальнаяСтоимость;
				СуммаИзносВсего       = СуммаИзносВсего + ВыборкаПоОС.Износ;
				КоличествоВсего 	  = КоличествоВсего + 1;  
				НаименованияОбъектов  = НаименованияОбъектов + СокрЛП(ВыборкаПоОС.НаименованиеОС) + " № " + СокрЛП(ВыборкаПоОС.ИнвентарныйНомер) + ", ";
				ТабличныйДокумент.Вывести(ОбластьМакета);
				
			КонецЦикла;
			
			ОбластьМакета 				 	= Макет.ПолучитьОбласть("Подвал");
			Параметры     				 	= ОбластьМакета.Параметры;
			Параметры.Заполнить(ВыборкаПоМОЛ);			
			Параметры.Заполнить(ВыборкаПоМестаХранения);			
			Параметры.СуммаВсего 	 	 	= СуммаВсего;
			Параметры.СуммаИзносаВсего 	 	= СуммаИзносВсего;
			Параметры.КоличествоВсего 		= КоличествоВсего;
			Параметры.НаименованияОбъектов  = Лев(НаименованияОбъектов, СтрДлина(НаименованияОбъектов)-2);
			ТабличныйДокумент.Вывести(ОбластьМакета);
			
			ТабличныйДокумент.ВывестиГоризонтальныйРазделительСтраниц();
			
			ОбластьМакета = Макет.ПолучитьОбласть("Страница2Шапка");
			Параметры     = ОбластьМакета.Параметры;
			Параметры.Заполнить(ВыборкаПоКомиссии);
			ОсновныеСотрудникиФизическихЛицСдал = КадровыйУчет.ОсновныеСотрудникиФизическихЛиц(ВыборкаПоМестаХранения.МОЛ, Истина, Ссылка.Организация, Ссылка.Дата);
			Если ЗначениеЗаполнено(ОсновныеСотрудникиФизическихЛицСдал) Тогда		
				Для каждого Строка Из ОсновныеСотрудникиФизическихЛицСдал Цикл
					ДанныеФизЛицаСдал = КадровыйУчет.КадровыеДанныеСотрудников(Истина, Строка.Сотрудник, "Должность", Ссылка.Дата);
				КонецЦикла;
				Для каждого СтрокаДанныеСдал Из ДанныеФизЛицаСдал Цикл
					ОбластьМакета.Параметры.СдалДолжность 	= СтрокаДанныеСдал.Должность;
					ОбластьМакета.Параметры.СдалФИО	 		= СтрокаДанныеСдал.ФизическоеЛицо;
				КонецЦикла;			
			КонецЕсли;
			
			ТабличныйДокумент.Вывести(ОбластьМакета);
			
			ОбластьМакета = Макет.ПолучитьОбласть("Страница2ДанныеБУСтрока");
			Параметры     = ОбластьМакета.Параметры;
			Если СписокМОЛ.Количество() = 2 Тогда 
				
				Пока ВыборкаБУ.Следующий() Цикл 
					
					Параметры.Заполнить(ВыборкаБУ); 
					Параметры.СчетКт = ?(ВыборкаБУ.СчетКт = ПланыСчетов.Хозрасчетный.ПустаяСсылка(), "-", ВыборкаБУ.СчетКт);
					Параметры.СчетДт = ?(ВыборкаБУ.СчетДт = ПланыСчетов.Хозрасчетный.ПустаяСсылка(), "-", ВыборкаБУ.СчетДт);
					ТабличныйДокумент.Вывести(ОбластьМакета);    
					
				КонецЦикла;
				
			Иначе
				
				ТабличныйДокумент.Вывести(ОбластьМакета);       
				
			КонецЕсли;
			
			ОбластьМакета = Макет.ПолучитьОбласть("Страница2ДанныеБУПодвал");
			Параметры     = ОбластьМакета.Параметры;
			Параметры.ОтветственныйДолжность = ДолжностиДляПечатиКлиентСервер.ДолжностьФизическогоЛица(Ссылка.Ответственный.ФизическоеЛицо, Ссылка.Организация, Ссылка.Дата);;
			Параметры.ОтветственныйФИО 		 = ФизическиеЛицаУТ.ФамилияИнициалыФизЛица(Ссылка.Ответственный.ФизическоеЛицо,Ссылка.Дата);			
			Параметры.ГлавныйБухгалтер 	 	 = ОтветственныеЛица.ГлавныйБухгалтерПредставление;
			
			ТабличныйДокумент.Вывести(ОбластьМакета);   
			НеПервая = Истина;
			
		КонецЦикла;    
		
	КонецЦикла;
	
КонецПроцедуры

Функция СформироватьПечатнуюФормуАктПриемаРемонтОС(МассивОбъектов, ОбъектыПечати, ПараметрыПечати, ИмяМакета)
	
	УстановитьПривилегированныйРежим(Истина);
	
	СтруктураТипов = ОбщегоНазначенияУТ.СоответствиеМассивовПоТипамОбъектов(МассивОбъектов);
	
	ТабличныйДокумент = Новый ТабличныйДокумент;

	ТабличныйДокумент.ИмяПараметровПечати = "ПАРАМЕТРЫ_ПЕЧАТИ_АктПриемаРемонтОС";
	
	НомерТипаДокумента = 0;
	
	СведенияАктуальны = Истина;
		
	Для Каждого СтруктураОбъектов Из СтруктураТипов Цикл
				
		МенеджерОбъекта = ОбщегоНазначения.МенеджерОбъектаПоПолномуИмени(СтруктураОбъектов.Ключ); 
				
		Для Каждого Элемент Из СтруктураОбъектов.Значение Цикл
			
			НомерТипаДокумента = НомерТипаДокумента + 1;
			Если НомерТипаДокумента > 1 Тогда                          	
				ТабличныйДокумент.ВывестиГоризонтальныйРазделительСтраниц();
			КонецЕсли;

			ДанныеДляПечати = МенеджерОбъекта.ПолучитьДанныеДляПечатнойФормыАктПриемаРемонт_2016(ПараметрыПечати, Элемент.Ссылка);
 	        НомерСтрокиНачало = ТабличныйДокумент.ВысотаТаблицы + 1;
			
			ЗаполнитьМакетАктПриемаРемонтОС(ТабличныйДокумент, ДанныеДляПечати, ОбъектыПечати, СведенияАктуальны, Элемент.Ссылка);
			
			// В табличном документе зададим имя области, в которую был 
			// выведен объект. Нужно для возможности печати покомплектно.
			УправлениеПечатью.ЗадатьОбластьПечатиДокумента(ТабличныйДокумент, 
			НомерСтрокиНачало, ОбъектыПечати, Элемент.Ссылка); 			
			
		КонецЦикла;
		
	КонецЦикла;
	
	Возврат ТабличныйДокумент;
	
КонецФункции

Процедура ЗаполнитьМакетАктПриемаРемонтОС(ТабличныйДокумент, ВыборкаПоДокументам, ОбъектыПечати, СведенияАктуальны, Ссылка)
	
	Макет = УправлениеПечатью.МакетПечатнойФормы("Обработка.ПечатьФормОСБюджет.ПФ_MXL_АктПриемаРемонтБюдж_2016");

	ВыборкаПоШапке  = ВыборкаПоДокументам.ВыборкаПоШапке.Выбрать();		
	ВыборкаПоШапке.Следующий();
	ВыборкаПоОС		= ВыборкаПоДокументам.ВыборкаПоОС.Выбрать();
	ВыборкаБУ 		= ВыборкаПоДокументам.ВыборкаБУ.Выбрать();		
	
	ОтветственныеЛица = ОтветственныеЛицаБП.ОтветственныеЛица(Ссылка.Организация, Ссылка.Дата);  
	
	ОбластьМакета = Макет.ПолучитьОбласть("Шапка");
	Параметры     = ОбластьМакета.Параметры;
	Параметры.Заполнить(ВыборкаПоШапке);
	СведенияОбОрганизации			 = ФормированиеПечатныхФорм.СведенияОЮрФизЛице(ВыборкаПоШапке.Организация, Ссылка.Дата);	
	Параметры.Организация			 = ФормированиеПечатныхФорм.ОписаниеОрганизации(СведенияОбОрганизации, "ПолноеНаименование,");
	Параметры.ЕДРПОУ				 = СведенияОбОрганизации.КодПоЕДРПОУ;		
	Параметры.Должность_Руководитель = ОтветственныеЛица.РуководительДолжностьПредставление;
	Параметры.ФИО_Руководитель		 = ОтветственныеЛица.РуководительПредставление;
	Параметры.ДатаАктаПрописью		 = Формат(ВыборкаПоШапке.ДатаАкта, "ДЛФ=ДД");
	Параметры.ДатаАкта				 = Формат(ВыборкаПоШапке.ДатаАкта, "ДЛФ=Д");
	ТабличныйДокумент.Вывести(ОбластьМакета); 
	
	ОбластьМакета = Макет.ПолучитьОбласть("Строка");
	Параметры     = ОбластьМакета.Параметры;
	
	Пока ВыборкаПоОС.Следующий() Цикл
		
		Параметры.Заполнить(ВыборкаПоОС);			
		ТабличныйДокумент.Вывести(ОбластьМакета);
		
	КонецЦикла;
	
	ОбластьМакета	= Макет.ПолучитьОбласть("Подвал");
	Параметры		= ОбластьМакета.Параметры;
	Параметры.Заполнить(ВыборкаПоШапке);
	Параметры.ДатаНачала		= Формат(ВыборкаПоШапке.ДатаНачала, "ДЛФ=Д");
	Параметры.ДатаОкончания 	= Формат(ВыборкаПоШапке.ДатаОкончания, "ДЛФ=Д");
	ТабличныйДокумент.Вывести(ОбластьМакета);
	
	ТабличныйДокумент.ВывестиГоризонтальныйРазделительСтраниц();
	
	ОбластьМакета = Макет.ПолучитьОбласть("Страница2Шапка");
	Параметры     = ОбластьМакета.Параметры;       
	
	ОсновныеСотрудникиФизическихЛицПринял = КадровыйУчет.ОсновныеСотрудникиФизическихЛиц(ВыборкаПоШапке.Принял, Истина, Ссылка.Организация, Ссылка.Дата);
	Если ЗначениеЗаполнено(ОсновныеСотрудникиФизическихЛицПринял) Тогда
		Для каждого Строка Из ОсновныеСотрудникиФизическихЛицПринял Цикл
			ДанныеФизЛицаПолучил = КадровыйУчет.КадровыеДанныеСотрудников(Истина, Строка.Сотрудник, "Должность", Ссылка.Дата);			
		КонецЦикла;
		Для каждого СтрокаДанныеПолучил Из ДанныеФизЛицаПолучил Цикл			
			Параметры.ПринялДолжность = СтрокаДанныеПолучил.Должность;
			Параметры.Принял 		  = СтрокаДанныеПолучил.ФизическоеЛицо;			
		КонецЦикла;
	КонецЕсли;
	ОсновныеСотрудникиФизическихЛицСдал = КадровыйУчет.ОсновныеСотрудникиФизическихЛиц(ВыборкаПоШапке.Сдал, Истина, Ссылка.Организация, Ссылка.Дата);
	Если ЗначениеЗаполнено(ОсновныеСотрудникиФизическихЛицСдал) Тогда		
		Для каждого Строка Из ОсновныеСотрудникиФизическихЛицСдал Цикл
			ДанныеФизЛицаСдал = КадровыйУчет.КадровыеДанныеСотрудников(Истина, Строка.Сотрудник, "Должность", Ссылка.Дата);
		КонецЦикла;
		Для каждого СтрокаДанныеСдал Из ДанныеФизЛицаСдал Цикл
			Параметры.СдалДолжность = СтрокаДанныеСдал.Должность;
			Параметры.Сдал	 		= СтрокаДанныеСдал.ФизическоеЛицо;
		КонецЦикла;			
	КонецЕсли;    
	
	ТабличныйДокумент.Вывести(ОбластьМакета);
	
	ОбластьМакета = Макет.ПолучитьОбласть("Страница2ДанныеБУСтрока");
	Параметры     = ОбластьМакета.Параметры;
	Если Ссылка.Проведен Тогда
				
		Пока ВыборкаБУ.Следующий() Цикл 
			
			Параметры.Заполнить(ВыборкаБУ); 
			Параметры.СчетКт = ?(ВыборкаБУ.СчетКт = ПланыСчетов.Хозрасчетный.ПустаяСсылка(), "-", ВыборкаБУ.СчетКт);
			Параметры.СчетДт = ?(ВыборкаБУ.СчетДт = ПланыСчетов.Хозрасчетный.ПустаяСсылка(), "-", ВыборкаБУ.СчетДт);
			ТабличныйДокумент.Вывести(ОбластьМакета);    
			
		КонецЦикла;
		
	Иначе
		
		ТабличныйДокумент.Вывести(ОбластьМакета);       
		
	КонецЕсли;
	
	ОбластьМакета = Макет.ПолучитьОбласть("Страница2ДанныеБУПодвал");
	Параметры     = ОбластьМакета.Параметры;
	Параметры.ОтветственныйДолжность = ДолжностиДляПечатиКлиентСервер.ДолжностьФизическогоЛица(Ссылка.Ответственный.ФизическоеЛицо, Ссылка.Организация, Ссылка.Дата);;
	Параметры.ОтветственныйФИО 		 = ФизическиеЛицаУТ.ФамилияИнициалыФизЛица(Ссылка.Ответственный.ФизическоеЛицо,Ссылка.Дата);			
	Параметры.ГлавныйБухгалтер 	 	 = ОтветственныеЛица.ГлавныйБухгалтерПредставление;
	
	ТабличныйДокумент.Вывести(ОбластьМакета);
	
КонецПроцедуры

Функция СформироватьПечатнуюФормуАктСписанияОС(МассивОбъектов, ОбъектыПечати, ПараметрыПечати, ИмяМакета)
	
	УстановитьПривилегированныйРежим(Истина);
	
	СтруктураТипов = ОбщегоНазначенияУТ.СоответствиеМассивовПоТипамОбъектов(МассивОбъектов);
	
	ТабличныйДокумент = Новый ТабличныйДокумент;

	ТабличныйДокумент.ИмяПараметровПечати = "ПАРАМЕТРЫ_ПЕЧАТИ_АктСписанияОС";
	
	НомерТипаДокумента = 0;
	
	СведенияАктуальны = Истина;
		
	Для Каждого СтруктураОбъектов Из СтруктураТипов Цикл
				
		МенеджерОбъекта = ОбщегоНазначения.МенеджерОбъектаПоПолномуИмени(СтруктураОбъектов.Ключ); 
				
		Для Каждого Элемент Из СтруктураОбъектов.Значение Цикл
			
			НомерТипаДокумента = НомерТипаДокумента + 1;
			Если НомерТипаДокумента > 1 Тогда                          	
				ТабличныйДокумент.ВывестиГоризонтальныйРазделительСтраниц();
			КонецЕсли;

			ДанныеДляПечати = МенеджерОбъекта.ПолучитьДанныеДляПечатнойФормыАктСписанияОС_2016(ПараметрыПечати, Элемент.Ссылка);
 	        НомерСтрокиНачало = ТабличныйДокумент.ВысотаТаблицы + 1;
			
			Если ТипЗнч(Элемент.Ссылка) = Тип("ДокументСсылка.СписаниеОС") Тогда
				ЗаполнитьМакетАктСписанияОС(ТабличныйДокумент, ДанныеДляПечати, ОбъектыПечати, СведенияАктуальны, Элемент.Ссылка);
			Иначе
				ЗаполнитьМакетАктСписанияОСМА(ТабличныйДокумент, ДанныеДляПечати, ОбъектыПечати, СведенияАктуальны, Элемент.Ссылка);
			КонецЕсли;   
			
			// В табличном документе зададим имя области, в которую был 
			// выведен объект. Нужно для возможности печати покомплектно.
			УправлениеПечатью.ЗадатьОбластьПечатиДокумента(ТабличныйДокумент, 
			НомерСтрокиНачало, ОбъектыПечати, Элемент.Ссылка); 			
			
		КонецЦикла;
		
	КонецЦикла;
	
	Возврат ТабличныйДокумент;
	
КонецФункции

Процедура ЗаполнитьМакетАктСписанияОС(ТабличныйДокумент, ВыборкаПоДокументам, ОбъектыПечати, СведенияАктуальны, Ссылка)
	
	Макет = УправлениеПечатью.МакетПечатнойФормы("Обработка.ПечатьФормОСБюджет.ПФ_MXL_АктСписанияОСБюдж_2016");
	
	ВыборкаПоШапке  = ВыборкаПоДокументам.ВыборкаПоШапке.Выбрать();		
	ВыборкаПоШапке.Следующий();
	СписокМОЛ = ВыборкаПоДокументам.ВыборкаПоОС.Выгрузить();
	СписокМОЛ.Свернуть("МОЛ");
	ВыборкаМОЛ = ВыборкаПоДокументам.ВыборкаПоОС.Выбрать(ОбходРезультатаЗапроса.ПоГруппировкам);
	ВыборкаБУ = ВыборкаПоДокументам.ВыборкаБУ.Выбрать();		
	
	ВыборкаПоКомиссии = ОбщегоНазначенияБПВызовСервера.ПолучитьСведенияОКомиссии(Ссылка);
	ОтветственныеЛица = ОтветственныеЛицаБП.ОтветственныеЛица(Ссылка.Организация, Ссылка.Дата);  
	
	НеПервая = Ложь;           
	Пока ВыборкаМОЛ.Следующий() Цикл     
		
		Если НеПервая Тогда
			ТабличныйДокумент.ВывестиГоризонтальныйРазделительСтраниц();
		КонецЕсли;  
		НеПервая = Истина;           
		
		ОбластьМакета = Макет.ПолучитьОбласть("Шапка");
		Параметры     = ОбластьМакета.Параметры;
		Параметры.Заполнить(ВыборкаПоШапке);
		СведенияОбОрганизации			 = ФормированиеПечатныхФорм.СведенияОЮрФизЛице(ВыборкаПоШапке.Организация, Ссылка.Дата);	
		Параметры.Организация			 = ФормированиеПечатныхФорм.ОписаниеОрганизации(СведенияОбОрганизации, "ПолноеНаименование,");
		Параметры.ЕДРПОУ				 = СведенияОбОрганизации.КодПоЕДРПОУ;		
		Параметры.Должность_Руководитель = ОтветственныеЛица.РуководительДолжностьПредставление;
		Параметры.ФИО_Руководитель		 = ОтветственныеЛица.РуководительПредставление;
		Параметры.ДатаАктаПрописью		 = Формат(ВыборкаПоШапке.ДатаАкта, "ДЛФ=DD");   
		
		ТабличныйДокумент.Вывести(ОбластьМакета); 
		
		ОбластьМакета = Макет.ПолучитьОбласть("Строка");
		Параметры     = ОбластьМакета.Параметры;
		
		ВыборкаПоОС = ВыборкаМОЛ.Выбрать();
		Пока ВыборкаПоОС.Следующий() Цикл  
			
			Параметры.Заполнить(ВыборкаПоОС);			
			Параметры.ЛиквидационнаяСтоимость = Формат(ВыборкаПоОС.ЛиквидационнаяСтоимость, "ЧЦ=15; ЧДЦ=2; ЧН=");   
			Параметры.ДатаВвода 			  = Формат(ВыборкаПоОС.ДатаВвода, "ДЛФ=Д");   
			СдалоПодразделение 				  =  ВыборкаПоОС.СдалоПодразделение;
			ТабличныйДокумент.Вывести(ОбластьМакета);
			
		КонецЦикла;
		
		ОбластьМакета	= Макет.ПолучитьОбласть("Подвал");
		Параметры		= ОбластьМакета.Параметры;
		Параметры.Заполнить(ВыборкаПоШапке);
		Параметры.Заполнить(ВыборкаПоКомиссии);
		
		ОсновныеСотрудникиФизическихЛицСдал = КадровыйУчет.ОсновныеСотрудникиФизическихЛиц(ВыборкаМОЛ.МОЛ, Истина, Ссылка.Организация, Ссылка.Дата);
		Если ЗначениеЗаполнено(ОсновныеСотрудникиФизическихЛицСдал) Тогда		
			Для каждого Строка Из ОсновныеСотрудникиФизическихЛицСдал Цикл
				ДанныеФизЛицаСдал = КадровыйУчет.КадровыеДанныеСотрудников(Истина, Строка.Сотрудник, "Должность", Ссылка.Дата);
			КонецЦикла;
			Для каждого СтрокаДанныеСдал Из ДанныеФизЛицаСдал Цикл
				Параметры.МОЛ_Должность = СтрокаДанныеСдал.Должность;
				Параметры.МОЛ_ФИО 		= СтрокаДанныеСдал.ФизическоеЛицо;
			КонецЦикла;			
		КонецЕсли;    
		
		ТабличныйДокумент.Вывести(ОбластьМакета);
		
		ОбластьМакета  = Макет.ПолучитьОбласть("ДанныеБУШапка");
		ТабличныйДокумент.Вывести(ОбластьМакета);
		ОбластьМакета  = Макет.ПолучитьОбласть("ДанныеБУСтрока");
		Параметры     = ОбластьМакета.Параметры;  
		Если СписокМОЛ.Количество() = 1 Тогда 
			
			Пока ВыборкаБУ.Следующий() Цикл 
				
				Параметры.Заполнить(ВыборкаБУ); 
				Параметры.СчетКт = ?(ВыборкаБУ.СчетКт = ПланыСчетов.Хозрасчетный.ПустаяСсылка(), "-", ВыборкаБУ.СчетКт);
				Параметры.СчетДт = ?(ВыборкаБУ.СчетДт = ПланыСчетов.Хозрасчетный.ПустаяСсылка(), "-", ВыборкаБУ.СчетДт);
				ТабличныйДокумент.Вывести(ОбластьМакета);    
				
			КонецЦикла;
			
		Иначе
			
			ТабличныйДокумент.Вывести(ОбластьМакета);       
			
		КонецЕсли;
		
		ОбластьМакета = Макет.ПолучитьОбласть("ДанныеБУПодвал");
		Параметры     = ОбластьМакета.Параметры;
		Параметры.ОтветственныйДолжность = ДолжностиДляПечатиКлиентСервер.ДолжностьФизическогоЛица(Ссылка.Ответственный.ФизическоеЛицо, Ссылка.Организация, Ссылка.Дата);;
		Параметры.ОтветственныйФИО 		 = ФизическиеЛицаУТ.ФамилияИнициалыФизЛица(Ссылка.Ответственный.ФизическоеЛицо,Ссылка.Дата);			
		Параметры.ГлавныйБухгалтер 	 	 = ОтветственныеЛица.ГлавныйБухгалтерПредставление;
		
		ТабличныйДокумент.Вывести(ОбластьМакета); 
		
	КонецЦикла;     

КонецПроцедуры

Процедура ЗаполнитьМакетАктСписанияОСМА(ТабличныйДокумент, ВыборкаПоДокументам, ОбъектыПечати, СведенияАктуальны, Ссылка)
	
	Макет = УправлениеПечатью.МакетПечатнойФормы("Обработка.ПечатьФормОСБюджет.ПФ_MXL_АктСписанияОСБюдж_2016");
	
	ВыборкаПоШапке  = ВыборкаПоДокументам.ВыборкаПоШапке.Выбрать();		
	ВыборкаПоШапке.Следующий();
	СписокМОЛ = ВыборкаПоДокументам.ВыборкаПоОС.Выгрузить();
	СписокМОЛ.Свернуть("МОЛ");
	ВыборкаМОЛ = ВыборкаПоДокументам.ВыборкаПоОС.Выбрать(ОбходРезультатаЗапроса.ПоГруппировкам);
	ВыборкаБУ = ВыборкаПоДокументам.ВыборкаБУ.Выбрать();		
	
	ВыборкаПоКомиссии = ОбщегоНазначенияБПВызовСервера.ПолучитьСведенияОКомиссии(Ссылка);
	ОтветственныеЛица = ОтветственныеЛицаБП.ОтветственныеЛица(Ссылка.Организация, Ссылка.Дата);  
	
	НеПервая = Ложь;           
	Пока ВыборкаМОЛ.Следующий() Цикл     
		
		Если НеПервая Тогда
			ТабличныйДокумент.ВывестиГоризонтальныйРазделительСтраниц();
		КонецЕсли;  
		НеПервая = Истина;           
		
		ОбластьМакета = Макет.ПолучитьОбласть("Шапка");
		Параметры     = ОбластьМакета.Параметры;
		Параметры.Заполнить(ВыборкаПоШапке);
		СведенияОбОрганизации			 = ФормированиеПечатныхФорм.СведенияОЮрФизЛице(ВыборкаПоШапке.Организация, Ссылка.Дата);	
		Параметры.Организация			 = ФормированиеПечатныхФорм.ОписаниеОрганизации(СведенияОбОрганизации, "ПолноеНаименование,");
		Параметры.ЕДРПОУ				 = СведенияОбОрганизации.КодПоЕДРПОУ;		
		Параметры.Должность_Руководитель = ОтветственныеЛица.РуководительДолжностьПредставление;
		Параметры.ФИО_Руководитель		 = ОтветственныеЛица.РуководительПредставление;
		Параметры.ДатаАктаПрописью		 = Формат(ВыборкаПоШапке.ДатаАкта, "ДЛФ=DD");   
		
		ТабличныйДокумент.Вывести(ОбластьМакета); 
		
		ОбластьМакета = Макет.ПолучитьОбласть("Строка");
		Параметры     = ОбластьМакета.Параметры;
		
		ВыборкаПоОС = ВыборкаМОЛ.Выбрать();
		Пока ВыборкаПоОС.Следующий() Цикл  
			
			Параметры.Заполнить(ВыборкаПоОС);			
			Параметры.ЛиквидационнаяСтоимость = Формат(ВыборкаПоОС.ЛиквидационнаяСтоимость, "ЧЦ=15; ЧДЦ=2; ЧН=");   
			Параметры.Амортизация			  = ВыборкаПоОС.ПервоначальнаяСтоимость;   
			Параметры.ДатаВвода				  = Формат(ВыборкаПоОС.ДатаВвода, "ДЛФ=Д");   
			Параметры.НаименованиеОС 		  = НоменклатураКлиентСервер.ПредставлениеНоменклатурыДляПечати(ВыборкаПоОС.НаименованиеОС, ВыборкаПоОС.Характеристика);
			ТабличныйДокумент.Вывести(ОбластьМакета);
			
		КонецЦикла;
		
		ОбластьМакета	= Макет.ПолучитьОбласть("Подвал");
		Параметры		= ОбластьМакета.Параметры;
		Параметры.Заполнить(ВыборкаПоШапке);
		Параметры.Заполнить(ВыборкаПоКомиссии);

		ОсновныеСотрудникиФизическихЛицСдал = КадровыйУчет.ОсновныеСотрудникиФизическихЛиц(ВыборкаМОЛ.МОЛ, Истина, Ссылка.Организация, Ссылка.Дата);
		Если ЗначениеЗаполнено(ОсновныеСотрудникиФизическихЛицСдал) Тогда		
			Для каждого Строка Из ОсновныеСотрудникиФизическихЛицСдал Цикл
				ДанныеФизЛицаСдал = КадровыйУчет.КадровыеДанныеСотрудников(Истина, Строка.Сотрудник, "Должность", Ссылка.Дата);
			КонецЦикла;
			Для каждого СтрокаДанныеСдал Из ДанныеФизЛицаСдал Цикл
				Параметры.МОЛ_Должность = СтрокаДанныеСдал.Должность;
				Параметры.МОЛ_ФИО 		= СтрокаДанныеСдал.ФизическоеЛицо;
			КонецЦикла;			
		КонецЕсли;    
		
		ТабличныйДокумент.Вывести(ОбластьМакета);
		
		ОбластьМакета  = Макет.ПолучитьОбласть("ДанныеБУШапка");
		ТабличныйДокумент.Вывести(ОбластьМакета);
		ОбластьМакета  = Макет.ПолучитьОбласть("ДанныеБУСтрока");
		Параметры     = ОбластьМакета.Параметры;  
		Если СписокМОЛ.Количество() = 1 Тогда 
			
			Пока ВыборкаБУ.Следующий() Цикл 
				
				Параметры.Заполнить(ВыборкаБУ); 
				Параметры.СчетКт = ?(ВыборкаБУ.СчетКт = ПланыСчетов.Хозрасчетный.ПустаяСсылка(), "-", ВыборкаБУ.СчетКт);
				Параметры.СчетДт = ?(ВыборкаБУ.СчетДт = ПланыСчетов.Хозрасчетный.ПустаяСсылка(), "-", ВыборкаБУ.СчетДт);
				ТабличныйДокумент.Вывести(ОбластьМакета);    
				
			КонецЦикла;
			
		Иначе
			
			ТабличныйДокумент.Вывести(ОбластьМакета);       
			
		КонецЕсли;
		
		ОбластьМакета = Макет.ПолучитьОбласть("ДанныеБУПодвал");
		Параметры     = ОбластьМакета.Параметры;
		Параметры.ОтветственныйДолжность = ДолжностиДляПечатиКлиентСервер.ДолжностьФизическогоЛица(Ссылка.Ответственный.ФизическоеЛицо, Ссылка.Организация, Ссылка.Дата);;
		Параметры.ОтветственныйФИО 		 = ФизическиеЛицаУТ.ФамилияИнициалыФизЛица(Ссылка.Ответственный.ФизическоеЛицо,Ссылка.Дата);			
		Параметры.ГлавныйБухгалтер 	 	 = ОтветственныеЛица.ГлавныйБухгалтерПредставление;
		
		ТабличныйДокумент.Вывести(ОбластьМакета); 
		
	КонецЦикла;     

КонецПроцедуры

Функция СформироватьПечатнуюФормуАктСписанияГруппаОС(МассивОбъектов, ОбъектыПечати, ПараметрыПечати, ИмяМакета)
	
	УстановитьПривилегированныйРежим(Истина);
	
	СтруктураТипов = ОбщегоНазначенияУТ.СоответствиеМассивовПоТипамОбъектов(МассивОбъектов);
	
	ТабличныйДокумент = Новый ТабличныйДокумент;

	ТабличныйДокумент.ИмяПараметровПечати = "ПАРАМЕТРЫ_ПЕЧАТИ_АктСписанияГруппыОС";
	
	НомерТипаДокумента = 0;
	
	СведенияАктуальны = Истина;
		
	Для Каждого СтруктураОбъектов Из СтруктураТипов Цикл
				
		МенеджерОбъекта = ОбщегоНазначения.МенеджерОбъектаПоПолномуИмени(СтруктураОбъектов.Ключ); 
				
		Для Каждого Элемент Из СтруктураОбъектов.Значение Цикл
			
			НомерТипаДокумента = НомерТипаДокумента + 1;
			Если НомерТипаДокумента > 1 Тогда                          	
				ТабличныйДокумент.ВывестиГоризонтальныйРазделительСтраниц();
			КонецЕсли;

			ДанныеДляПечати = МенеджерОбъекта.ПолучитьДанныеДляПечатнойФормыАктСписанияГруппаОС_2016(ПараметрыПечати, Элемент.Ссылка);
 	        НомерСтрокиНачало = ТабличныйДокумент.ВысотаТаблицы + 1;
			
			ЗаполнитьМакетАктСписанияГруппаОС(ТабличныйДокумент, ДанныеДляПечати, ОбъектыПечати, СведенияАктуальны, Элемент.Ссылка);
			
			// В табличном документе зададим имя области, в которую был 
			// выведен объект. Нужно для возможности печати покомплектно.
			УправлениеПечатью.ЗадатьОбластьПечатиДокумента(ТабличныйДокумент, 
			НомерСтрокиНачало, ОбъектыПечати, Элемент.Ссылка); 			
			
		КонецЦикла;
		
	КонецЦикла;
	
	Возврат ТабличныйДокумент;
	
КонецФункции

Процедура ЗаполнитьМакетАктСписанияГруппаОС(ТабличныйДокумент, ВыборкаПоДокументам, ОбъектыПечати, СведенияАктуальны, Ссылка)
	
	Макет = УправлениеПечатью.МакетПечатнойФормы("Обработка.ПечатьФормОСБюджет.ПФ_MXL_АктСписанияОСГруппаБюдж_2016");
	
	ВыборкаПоШапке  = ВыборкаПоДокументам.ВыборкаПоШапке.Выбрать();		
	ВыборкаПоШапке.Следующий();
	СписокМОЛ = ВыборкаПоДокументам.ВыборкаПоОС.Выгрузить();
	СписокМОЛ.Свернуть("МОЛ");
	ВыборкаМОЛ = ВыборкаПоДокументам.ВыборкаПоОС.Выбрать(ОбходРезультатаЗапроса.ПоГруппировкам);
	ВыборкаБУ = ВыборкаПоДокументам.ВыборкаБУ.Выбрать();		
	
	ВыборкаПоКомиссии = ОбщегоНазначенияБПВызовСервера.ПолучитьСведенияОКомиссии(Ссылка);
	ОтветственныеЛица = ОтветственныеЛицаБП.ОтветственныеЛица(Ссылка.Организация, Ссылка.Дата);  
	
	НеПервая = Ложь;           
	Пока ВыборкаМОЛ.Следующий() Цикл     
		
		Если НеПервая Тогда
			ТабличныйДокумент.ВывестиГоризонтальныйРазделительСтраниц();
		КонецЕсли;  
		НеПервая = Истина;           
		
		ОбластьМакета = Макет.ПолучитьОбласть("Шапка");
		Параметры     = ОбластьМакета.Параметры;
		Параметры.Заполнить(ВыборкаПоШапке);
		СведенияОбОрганизации			 = ФормированиеПечатныхФорм.СведенияОЮрФизЛице(ВыборкаПоШапке.Организация, Ссылка.Дата);	
		Параметры.Организация			 = ФормированиеПечатныхФорм.ОписаниеОрганизации(СведенияОбОрганизации, "ПолноеНаименование,");
		Параметры.ЕДРПОУ				 = СведенияОбОрганизации.КодПоЕДРПОУ;		
		Параметры.Должность_Руководитель = ОтветственныеЛица.РуководительДолжностьПредставление;
		Параметры.ФИО_Руководитель		 = ОтветственныеЛица.РуководительПредставление;
		Параметры.ДатаАктаПрописью		 = Формат(ВыборкаПоШапке.ДатаАкта, "ДЛФ=DD");   
		
		ТабличныйДокумент.Вывести(ОбластьМакета); 
		
		ОбластьМакета = Макет.ПолучитьОбласть("Строка");
		Параметры     = ОбластьМакета.Параметры;
		
		ВыборкаПоОС = ВыборкаМОЛ.Выбрать();
		КоличествоВсего = 0;
		СуммаВсего = 0;
		Пока ВыборкаПоОС.Следующий() Цикл  
			
			Параметры.Заполнить(ВыборкаПоОС);			
			Параметры.НаименованиеОС = НоменклатураКлиентСервер.ПредставлениеНоменклатурыДляПечати(ВыборкаПоОС.НоменклатураНаименование, ВыборкаПоОС.Характеристика);
			Параметры.ДатаВвода   = Формат(ВыборкаПоОС.ДатаВвода, "ДЛФ=Д");  
			Сумма = ?(Ссылка.Проведен, ВыборкаПоОС.Количество * ВыборкаПоОС.ПервоначальнаяСтоимость, 0);
			Параметры.Сумма 	  = Сумма;   
			СуммаВсего			  = СуммаВсего + Сумма;   
			КоличествоВсего 	  = КоличествоВсего + ?(Ссылка.Проведен, ВыборкаПоОС.Количество, 0);   
			
			ТабличныйДокумент.Вывести(ОбластьМакета);
			
		КонецЦикла;
		
		ОбластьМакета	= Макет.ПолучитьОбласть("Подвал");
		Параметры		= ОбластьМакета.Параметры;
		Параметры.СуммаВсего 	  = СуммаВсего;
		Параметры.КоличествоВсего = КоличествоВсего;
		Параметры.Заполнить(ВыборкаПоШапке);
		
		ОсновныеСотрудникиФизическихЛицСдал = КадровыйУчет.ОсновныеСотрудникиФизическихЛиц(ВыборкаМОЛ.МОЛ, Истина, Ссылка.Организация, Ссылка.Дата);
		Если ЗначениеЗаполнено(ОсновныеСотрудникиФизическихЛицСдал) Тогда		
			Для каждого Строка Из ОсновныеСотрудникиФизическихЛицСдал Цикл
				ДанныеФизЛицаСдал = КадровыйУчет.КадровыеДанныеСотрудников(Истина, Строка.Сотрудник, "Должность", Ссылка.Дата);
			КонецЦикла;
			Для каждого СтрокаДанныеСдал Из ДанныеФизЛицаСдал Цикл
				Параметры.МОЛ_Должность = СтрокаДанныеСдал.Должность;
				Параметры.МОЛ_ФИО 		= СтрокаДанныеСдал.ФизическоеЛицо;
			КонецЦикла;			
		КонецЕсли;    
		ТабличныйДокумент.Вывести(ОбластьМакета);
		
		ТабличныйДокумент.ВывестиГоризонтальныйРазделительСтраниц();
		ОбластьМакета	= Макет.ПолучитьОбласть("Комиссия");
		Параметры     = ОбластьМакета.Параметры;
		Параметры.Заполнить(ВыборкаПоКомиссии);
		Параметры.Заполнить(ОбластьМакета);
		
		ТабличныйДокумент.Вывести(ОбластьМакета);
		ОбластьМакета = Макет.ПолучитьОбласть("РезультатСписания");
		ТабличныйДокумент.Вывести(ОбластьМакета);
		
		ОбластьМакета  = Макет.ПолучитьОбласть("ДанныеБУШапка");
		ТабличныйДокумент.Вывести(ОбластьМакета);
		ОбластьМакета  = Макет.ПолучитьОбласть("ДанныеБУСтрока");
		Параметры     = ОбластьМакета.Параметры;  
		Если СписокМОЛ.Количество() = 1 Тогда 
			
			Пока ВыборкаБУ.Следующий() Цикл 
				
				Параметры.Заполнить(ВыборкаБУ); 
				Параметры.СчетКт = ?(ВыборкаБУ.СчетКт = ПланыСчетов.Хозрасчетный.ПустаяСсылка(), "-", ВыборкаБУ.СчетКт);
				Параметры.СчетДт = ?(ВыборкаБУ.СчетДт = ПланыСчетов.Хозрасчетный.ПустаяСсылка(), "-", ВыборкаБУ.СчетДт);
				ТабличныйДокумент.Вывести(ОбластьМакета);    
				
			КонецЦикла;
			
		Иначе
			
			ТабличныйДокумент.Вывести(ОбластьМакета);       
			
		КонецЕсли;
		
		ОбластьМакета = Макет.ПолучитьОбласть("ДанныеБУПодвал");
		Параметры     = ОбластьМакета.Параметры;
		Параметры.ОтветственныйДолжность = ДолжностиДляПечатиКлиентСервер.ДолжностьФизическогоЛица(Ссылка.Ответственный.ФизическоеЛицо, Ссылка.Организация, Ссылка.Дата);;
		Параметры.ОтветственныйФИО 		 = ФизическиеЛицаУТ.ФамилияИнициалыФизЛица(Ссылка.Ответственный.ФизическоеЛицо,Ссылка.Дата);			
		Параметры.ГлавныйБухгалтер 	 	 = ОтветственныеЛица.ГлавныйБухгалтерПредставление;
		
		ТабличныйДокумент.Вывести(ОбластьМакета); 
		НеПервая = Истина;
		
	КонецЦикла;    

КонецПроцедуры

#КонецОбласти

#КонецЕсли


